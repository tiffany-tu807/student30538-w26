<!DOCTYPE html>
<html lang="en"><head>
<script src="dashboards_files/libs/clipboard/clipboard.min.js"></script>
<script src="dashboards_files/libs/quarto-html/tabby.min.js"></script>
<script src="dashboards_files/libs/quarto-html/popper.min.js"></script>
<script src="dashboards_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="dashboards_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dashboards_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="dashboards_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="Peter Ganong and Maggie Shi">
  <meta name="dcterms.date" content="2026-02-17">
  <title>Dashboards</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="dashboards_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Dashboards</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Peter Ganong and Maggie Shi 
</div>
</div>
</div>

  <p class="date">February 17, 2026</p>
</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

<!--
## Table of contents

::: {.toc}

:::-->
</section>
<section id="skills-acquired-by-end-of-lecture" class="slide level2">
<h2>Skills acquired by end of lecture</h2>
<ul>
<li>Understand benefits (and drawbacks) of dashboards</li>
<li>Launch <code>streamlit</code> dashboards locally and deploy online</li>
<li>Make basic static and interactive dashboards</li>
<li>Set up dashboards that run efficiently</li>
</ul>
</section>
<section id="materials-for-this-lecture" class="slide level2" style="font-size: 0.9em">
<h2>Materials for this lecture</h2>
<ul>
<li>We will review code for several example dashboards</li>
<li><code>all_snippets.pdf</code>: all code reviewed in lecture</li>
<li>Full source code for example dashboards stored in a separate repo than student repo: <a href="https://github.com/uchicago-harris-dap/dashboards">https://github.com/uchicago-harris-dap/dashboards</a>.
<ul>
<li>Clone to access source code and launch apps locally</li>
<li>When lecture material says <code>1/hello_world_1.py</code>, <code>2/hello_world_2_local.py</code>, we are referencing this repo</li>
<li>Example dashboards are also deployed online and linked</li>
</ul></li>
</ul>
</section>
<section id="from-a-static-process" class="slide level2">
<h2>From A Static Process</h2>

<img data-src="pictures/process_1.png" style="width:70.0%" class="r-stretch quarto-figure-center"><aside class="notes">
<ul>
<li>Review table of contents (does not render as a separate slide)</li>
<li>When you submit a problem set or read a paper, It usually is imagined to follow a process like this</li>
<li>Number one you write the code</li>
<li>number two you run the code</li>
<li>number three the recipient looks like at output.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_2.png" style="width:70.0%" class="r-stretch quarto-figure-center"><aside class="notes">
<ul>
<li>Except that for anyone who has spent time at the Harris School or in another research environment, you know that this is not actually anything like how research happens.</li>
<li>In practice after you look at the output, you interact with the output and then you go back and you change the code and you run the code again and you look at the output again.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process-1" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_2.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p>When you analyze a dataset, your process looks a lot more like the dynamic one than the static one.</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process-2" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_3.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p>Dashboards allow someone who does not code to do a limited version of the same process you go through as you code.</p>
<aside class="notes">
<p>What dashboards to do is they enable someone who does not write code to do a small scale version of the skill that you already have, which is to manipulate the code and re-examine the output.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process-3" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_4.png" style="width:70.0%" class="r-stretch quarto-figure-center"><aside class="notes">
<p>The other thing dashboard is that they need your code to be run not just on your computer but also run on a personal web server.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="other-benefits-of-dashboards" class="slide level2">
<h2>Other benefits of dashboards</h2>
<ul>
<li>There are two other major benefits of dashboards which we will not spend time on in class, but you should also know about
<ul>
<li>Consolidated information: aggregate data from various sources into one unified interface</li>
<li>Real-time data metrics: dynamic view based on automatically-updated data feed</li>
</ul></li>
<li><em>(Third benefit is that they are impressive: they are a great way to flex your data skills for your portfolio!)</em></li>
</ul>
</section>
<section id="where-we-are-going" class="slide level2">
<h2>Where we are going</h2>
<p><a href="http://uchicago-harris-dap-dashboards-4.streamlit.app/">http://uchicago-harris-dap-dashboards-4.streamlit.app/</a></p>
<aside class="notes">
<p>Poke around here a bit to clarify that this is what we will be able to do by the end of the lecture note</p>
<p>Points to highlight: * There is an underlying dataset that the user does not see that is generating all of these graphics * Discussion question: what are the variables in this dataset? * hour of pickup * minute of pickup * number of pickup * Some kind of geography * There must be code that generates the maps as well as the graph * Slider to select hour of pickup: equivalent to subsetting this dataset by hour of pickup * When user selects a value in the slider, in the background the dataset is being subsetted to another hour, and the maps and graphs are being re-generated based on that subset. * Side note: 3D graphs :( we are using this because this is a classic streamlit example</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dashboards-promises-and-pitfalls" class="slide level2">
<h2>Dashboards: Promises and Pitfalls</h2>
<p>When Professor Ganong worked in the Mayor‚Äôs Office in Boston, the mayor asked for every single department to suggest metrics for a dashboard. The mayor put a TV in his office so that the dashboards would be displayed at all times.</p>
<p><strong>Discussion questions</strong>:</p>
<ol type="1">
<li>What are examples of data that a city would benefit from tracking with a dashboard?</li>
<li>What are examples of data where putting it on a dashboard might inadvertently lead to poor management or create bad incentives for workers?</li>
</ol>
<aside class="notes">
<ol type="1">
<li><p>Clearance rate for reported crimes, School attendance, Number of snow plows in operation Number of overdoses</p></li>
<li><p>Number of closed citizen complaints. Not good because it creates an incentive to close complaints rapidly rather than to make sure that they are actually solved. Number of miles covered by street sweepers. Not good because it incentivizes covering ground rather than doubling back when something is missed to make sure it is actually cleaned. Number of cars towed. Not clear if we want this metric to be high or low, depends on the context.</p></li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="streamlit" class="slide level2" style="font-size: 0.8em">
<h2><code>streamlit</code></h2>
<p>We are teaching dashboards using <code>streamlit</code>. This is designed for data scientists who want to share analyses without needing front-end (e.g., web design) development skills. Beyond being easy to use, we chose to teach <code>streamlit</code> for a few reasons:</p>
<ol type="1">
<li>Native to Python, works well with existing Python tools (e.g.&nbsp;Altair)</li>
<li>All its features are free (so long as you are making public dashboards)</li>
<li>Open source: <a href="https://github.com/streamlit/streamlit">https://github.com/streamlit/streamlit</a></li>
</ol>
<p>Caveat: <code>streamlit</code> is for prototyping (not computationally efficient for many users). We will talk more at the end of the lecture about how you will use streamlit and other tools going forward.</p>
<aside class="notes">
<p>It is most useful for creating a prototype. If someone decides it is needs to be accessed by many users or needs to be built on top of secure data it will be replicated using a different dashboarding tool. This is very common. When professor Ganong worked at the city of Boston, everything that was going to be used on a continuing basis was transferred to another more stable platform.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="citing-our-sources" class="slide level2">
<h2>Citing our sources</h2>
<ul>
<li>These lecture slides draw on examples and text from <a href="https://docs.streamlit.io">https://docs.streamlit.io</a>.</li>
<li><code>streamlit</code> has fantastic documentation and <a href="https://streamlit.io/gallery">app gallery</a></li>
</ul>
</section>
<section id="introduction-summary" class="slide level2">
<h2>Introduction: summary</h2>
<ul>
<li>Dashboards let non-coders interact with data</li>
<li>Introduce <code>streamlit</code></li>
<li>Note on process: this is our first year teaching this lecture note so we are highly uncertain how long it will take (both each slide and the lecture overall)</li>
</ul>
<aside class="notes">
<p>Review table of contents for the rest of lecture</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="dashboards-as-websites" class="title-slide slide level1 center">
<h1>Dashboards as websites</h1>

</section>
<section id="prep" class="slide level2">
<h2>Prep</h2>
<ul>
<li>Create a separate repo just for your dashboards. Ours is <a href="https://github.com/uchicago-harris-dap/dashboards">https://github.com/uchicago-harris-dap/dashboards</a></li>
<li>Be sure it is public.</li>
<li>Save code; we will call this <code>1/hello_world_1.py</code></li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb1-2"><a href="#cb1-2"></a>st.write(<span class="st">"""</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="st"># My first app</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">Hello *world!*</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Push code</li>
</ul>
<aside class="notes">
<p>Syntax notes * ‚Äú‚Äú‚Äú‚Ä¶‚Äù‚Äú‚Äù in Python creates a strong that can span multiple lines * <code>#</code> defines header text ‚Äì like in QMD * <code>*</code> defines italicized text</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="my-first-dashboard" class="slide level2">
<h2>My first dashboard</h2>
<p>In this lecture: <code>$</code> means run at the terminal (on Macs the prefix is <code>%</code>). You do not need to type <code>$</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource {bash} number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>$ streamlit run 1/hello_world_1.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Recall: <code>Ctrl + C</code> to exit in Terminal</li>
</ul>
<aside class="notes">
<p>We will start with the most simple possible dashboard. If you want to run this code, you can do just two steps first to install streamlit by running this first line of code at the terminal and then you run the script again at the command line.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="my-first-dashboard-two-ways-to-display" class="slide level2">
<h2>My first dashboard ‚Äì two ways to display</h2>
<ol type="1">
<li><strong>Local</strong> Create a server on your computer. Access from your web browser (and no one else‚Äôs). Like we did on prior slide.</li>
<li><strong>Online</strong> Create a server in the cloud. Access from any web browser.</li>
</ol>
</section>
<section id="my-first-dashboard-putting-it-online" class="slide level2">
<h2>My first dashboard ‚Äì putting it online</h2>
<ul>
<li><em>(one time only)</em> connect your github account to streamlit community cloud. <a href="https://streamlit.io/cloud">(here)</a></li>
<li>Three clicks: Deploy -&gt; Deploy Now (under Streamlit Community Cloud) -&gt; Deploy (with pre-filled repo, branch, and file names).</li>
<li>Now your app is online and can be shared via link: <a href="http://uchicago-harris-dap-dashboards-1.streamlit.app/">http://uchicago-harris-dap-dashboards-1.streamlit.app/</a></li>
<li>Workflow: Streamlit does <strong>not</strong> actually deploy the script which is stored on your computer. Instead, it reads the script which is pushed to your public repo and deploys that.</li>
</ul>
<aside class="notes">
<p>Comment for maggie: You might wonder how it is possible that we will be live-deploying the same script multiple times (once every class). The answer is that each time we are just over-writing the existing deployment.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="my-second-dashboard" class="slide level2">
<h2>My second dashboard</h2>
<ul>
<li><code>$ streamlit run 2/hello_world_2_local.py</code></li>
<li>Uncomment <code>st.altair_chart(chart_to_show)</code>. Save. Show detection of file change.
<ul>
<li>Fun fact: streamlit will automatically figure out how to print various data types to the web so you also can instead just write <code>chart_to_show</code>.</li>
</ul></li>
<li>This is the normal workflow for building a streamlit dashboard. Update code. Save. Re-run locally. Once you are happy, then you deploy.</li>
<li><a href="http://uchicago-harris-dap-dashboards-2.streamlit.app/">http://uchicago-harris-dap-dashboards-2.streamlit.app/</a></li>
</ul>
<aside class="notes">
<p>Next I will show slightly more sophisticated script (SCREEN: hello_world_2_local.py)</p>
<p>In this script, I‚Äôm going to need the Seattle weather file that you used earlier and visualization and then I‚Äôm going to make a chart out of it.</p>
<p>Point to pandas command.</p>
<p>Point to altair command.</p>
<p>SCREEN: Slide. Implement the steps described in the slide.</p>
<p>For the rest of this lecture, we aren‚Äôt going to do any more live deployments (creates unnecessary live debugging) so instead just visit the deployed dashboard on the web.</p>
<p>SCREEN: <a href="http://uchicago-harris-dap-dashboards-2.streamlit.app/">http://uchicago-harris-dap-dashboards-2.streamlit.app/</a>. On that page, review ‚Äúmanage app‚Äù, ‚Äúrecord a screencast‚Äù</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="interactive-dashboards" class="title-slide slide level1 center">
<h1>Interactive dashboards</h1>

</section>
<section id="roadmap" class="slide level2">
<h2>Roadmap</h2>
<p>Dashboard 3. Multipage.</p>
<p>Do-pair-share.</p>
<p>Dashboard 4. Uber pickups. ‚ÄúClassic‚Äù streamlit dashboard.</p>
</section>
<section id="dashboard-3-roadmap" class="slide level2">
<h2>Dashboard 3 roadmap</h2>
<ol type="1">
<li>Homepage with dropdown menu</li>
<li>Plotting demo with button</li>
<li>Dataframe demo with selection box and table</li>
<li>Mapping demo with checkboxes</li>
</ol>
<p>Preview <a href="http://uchicago-harris-dap-dashboards-3b.streamlit.app/">http://uchicago-harris-dap-dashboards-3b.streamlit.app/</a></p>
<p>Going forward, we won‚Äôt deploy locally anymore. But all the source code is located in the dashboards repo. For this one, you would deploy locally using <code>streamlit run 3/multipage.py</code></p>
</section>
<section id="dashboard-3-homepage-review-code" class="slide level2" style="font-size: 0.8em">
<h2>Dashboard 3 Homepage Review code</h2>
<ul>
<li>Review structure of page and <code>intro()</code></li>
<li><em>Lines 226-234</em>: created via <code>page_names_to_funcs</code> and <code>st.sidebar.selectbox(...)</code></li>
</ul>
<p><code>3/multipage.py</code>:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Multipage Demo"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">def</span> intro():</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>    st.write(<span class="st">"# Welcome to Streamlit! üëã"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>    st.sidebar.success(<span class="st">"Select a demo above."</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>    st.markdown(</span>
<span id="cb3-13"><a href="#cb3-13"></a>        <span class="st">"""</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">        Streamlit is an open-source app framework built specifically for</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="st">        Machine Learning and Data Science projects.</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="st">        **üëà Select a demo from the dropdown on the left** to see some examples</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="st">        of what Streamlit can do!</span></span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="st">        ### Want to learn more?</span></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="st">        - Check out [streamlit.io](https://streamlit.io)</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="st">        - Jump into our [documentation](https://docs.streamlit.io)</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="st">        - Ask a question in our [community</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">          forums](https://discuss.streamlit.io)</span></span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">        ### See more complex demos</span></span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">        - Explore a [New York City rideshare dataset](https://github.com/streamlit/demo-uber-nyc-pickups)</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="st">    """</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="kw">def</span> mapping_demo():</span>
<span id="cb3-34"><a href="#cb3-34"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-35"><a href="#cb3-35"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-36"><a href="#cb3-36"></a>    <span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a>    st.markdown(<span class="st">"# Mapping Demo"</span>)</span>
<span id="cb3-41"><a href="#cb3-41"></a>    st.write(</span>
<span id="cb3-42"><a href="#cb3-42"></a>        <span class="st">"""</span></span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="st">        This demo shows how to use</span></span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="st">[`st.pydeck_chart`](https://docs.streamlit.io/develop/api-reference/charts/st.pydeck_chart)</span></span>
<span id="cb3-45"><a href="#cb3-45"></a><span class="st">to display geospatial data.</span></span>
<span id="cb3-46"><a href="#cb3-46"></a><span class="st">"""</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>    )</span>
<span id="cb3-48"><a href="#cb3-48"></a></span>
<span id="cb3-49"><a href="#cb3-49"></a>    <span class="at">@st.cache_data</span></span>
<span id="cb3-50"><a href="#cb3-50"></a>    <span class="kw">def</span> from_data_file(filename):</span>
<span id="cb3-51"><a href="#cb3-51"></a>        url <span class="op">=</span> (</span>
<span id="cb3-52"><a href="#cb3-52"></a>            <span class="st">"http://raw.githubusercontent.com/streamlit/"</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>            <span class="st">"example-data/master/hello/v1/</span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> filename</span>
<span id="cb3-54"><a href="#cb3-54"></a>        )</span>
<span id="cb3-55"><a href="#cb3-55"></a>        <span class="cf">return</span> pd.read_json(url)</span>
<span id="cb3-56"><a href="#cb3-56"></a></span>
<span id="cb3-57"><a href="#cb3-57"></a>    <span class="cf">try</span>:</span>
<span id="cb3-58"><a href="#cb3-58"></a>        ALL_LAYERS <span class="op">=</span> {</span>
<span id="cb3-59"><a href="#cb3-59"></a>            <span class="st">"Bike Rentals"</span>: pdk.Layer(</span>
<span id="cb3-60"><a href="#cb3-60"></a>                <span class="st">"HexagonLayer"</span>,</span>
<span id="cb3-61"><a href="#cb3-61"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bike_rental_stats.json"</span>),</span>
<span id="cb3-62"><a href="#cb3-62"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb3-63"><a href="#cb3-63"></a>                radius<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb3-64"><a href="#cb3-64"></a>                elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb3-65"><a href="#cb3-65"></a>                elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb3-66"><a href="#cb3-66"></a>                extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-67"><a href="#cb3-67"></a>            ),</span>
<span id="cb3-68"><a href="#cb3-68"></a>            <span class="st">"Bart Stop Exits"</span>: pdk.Layer(</span>
<span id="cb3-69"><a href="#cb3-69"></a>                <span class="st">"ScatterplotLayer"</span>,</span>
<span id="cb3-70"><a href="#cb3-70"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb3-71"><a href="#cb3-71"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb3-72"><a href="#cb3-72"></a>                get_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb3-73"><a href="#cb3-73"></a>                get_radius<span class="op">=</span><span class="st">"[exits]"</span>,</span>
<span id="cb3-74"><a href="#cb3-74"></a>                radius_scale<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb3-75"><a href="#cb3-75"></a>            ),</span>
<span id="cb3-76"><a href="#cb3-76"></a>            <span class="st">"Bart Stop Names"</span>: pdk.Layer(</span>
<span id="cb3-77"><a href="#cb3-77"></a>                <span class="st">"TextLayer"</span>,</span>
<span id="cb3-78"><a href="#cb3-78"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb3-79"><a href="#cb3-79"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb3-80"><a href="#cb3-80"></a>                get_text<span class="op">=</span><span class="st">"name"</span>,</span>
<span id="cb3-81"><a href="#cb3-81"></a>                get_color<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">200</span>],</span>
<span id="cb3-82"><a href="#cb3-82"></a>                get_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb3-83"><a href="#cb3-83"></a>                get_alignment_baseline<span class="op">=</span><span class="st">"'bottom'"</span>,</span>
<span id="cb3-84"><a href="#cb3-84"></a>            ),</span>
<span id="cb3-85"><a href="#cb3-85"></a>            <span class="st">"Outbound Flow"</span>: pdk.Layer(</span>
<span id="cb3-86"><a href="#cb3-86"></a>                <span class="st">"ArcLayer"</span>,</span>
<span id="cb3-87"><a href="#cb3-87"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_path_stats.json"</span>),</span>
<span id="cb3-88"><a href="#cb3-88"></a>                get_source_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb3-89"><a href="#cb3-89"></a>                get_target_position<span class="op">=</span>[<span class="st">"lon2"</span>, <span class="st">"lat2"</span>],</span>
<span id="cb3-90"><a href="#cb3-90"></a>                get_source_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb3-91"><a href="#cb3-91"></a>                get_target_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb3-92"><a href="#cb3-92"></a>                auto_highlight<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-93"><a href="#cb3-93"></a>                width_scale<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span id="cb3-94"><a href="#cb3-94"></a>                get_width<span class="op">=</span><span class="st">"outbound"</span>,</span>
<span id="cb3-95"><a href="#cb3-95"></a>                width_min_pixels<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb3-96"><a href="#cb3-96"></a>                width_max_pixels<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb3-97"><a href="#cb3-97"></a>            ),</span>
<span id="cb3-98"><a href="#cb3-98"></a>        }</span>
<span id="cb3-99"><a href="#cb3-99"></a>        st.sidebar.markdown(<span class="st">"### Map Layers"</span>)</span>
<span id="cb3-100"><a href="#cb3-100"></a>        selected_layers <span class="op">=</span> [</span>
<span id="cb3-101"><a href="#cb3-101"></a>            layer</span>
<span id="cb3-102"><a href="#cb3-102"></a>            <span class="cf">for</span> layer_name, layer <span class="kw">in</span> ALL_LAYERS.items()</span>
<span id="cb3-103"><a href="#cb3-103"></a>            <span class="cf">if</span> st.sidebar.checkbox(layer_name, <span class="va">True</span>)</span>
<span id="cb3-104"><a href="#cb3-104"></a>        ]</span>
<span id="cb3-105"><a href="#cb3-105"></a>        <span class="cf">if</span> selected_layers:</span>
<span id="cb3-106"><a href="#cb3-106"></a>            st.pydeck_chart(</span>
<span id="cb3-107"><a href="#cb3-107"></a>                pdk.Deck(</span>
<span id="cb3-108"><a href="#cb3-108"></a>                    map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb3-109"><a href="#cb3-109"></a>                    initial_view_state<span class="op">=</span>{</span>
<span id="cb3-110"><a href="#cb3-110"></a>                        <span class="st">"latitude"</span>: <span class="fl">37.76</span>,</span>
<span id="cb3-111"><a href="#cb3-111"></a>                        <span class="st">"longitude"</span>: <span class="op">-</span><span class="fl">122.4</span>,</span>
<span id="cb3-112"><a href="#cb3-112"></a>                        <span class="st">"zoom"</span>: <span class="dv">11</span>,</span>
<span id="cb3-113"><a href="#cb3-113"></a>                        <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb3-114"><a href="#cb3-114"></a>                    },</span>
<span id="cb3-115"><a href="#cb3-115"></a>                    layers<span class="op">=</span>selected_layers,</span>
<span id="cb3-116"><a href="#cb3-116"></a>                )</span>
<span id="cb3-117"><a href="#cb3-117"></a>            )</span>
<span id="cb3-118"><a href="#cb3-118"></a>        <span class="cf">else</span>:</span>
<span id="cb3-119"><a href="#cb3-119"></a>            st.error(<span class="st">"Please choose at least one layer above."</span>)</span>
<span id="cb3-120"><a href="#cb3-120"></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb3-121"><a href="#cb3-121"></a>        st.error(</span>
<span id="cb3-122"><a href="#cb3-122"></a>            <span class="st">"""</span></span>
<span id="cb3-123"><a href="#cb3-123"></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb3-124"><a href="#cb3-124"></a></span>
<span id="cb3-125"><a href="#cb3-125"></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb3-126"><a href="#cb3-126"></a><span class="st">        """</span></span>
<span id="cb3-127"><a href="#cb3-127"></a>            <span class="op">%</span> e.reason</span>
<span id="cb3-128"><a href="#cb3-128"></a>        )</span>
<span id="cb3-129"><a href="#cb3-129"></a></span>
<span id="cb3-130"><a href="#cb3-130"></a><span class="kw">def</span> plotting_demo():</span>
<span id="cb3-131"><a href="#cb3-131"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-132"><a href="#cb3-132"></a>    <span class="im">import</span> time</span>
<span id="cb3-133"><a href="#cb3-133"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-134"><a href="#cb3-134"></a></span>
<span id="cb3-135"><a href="#cb3-135"></a>    st.markdown(<span class="st">"# Plotting Demo"</span>)</span>
<span id="cb3-136"><a href="#cb3-136"></a>    st.write(</span>
<span id="cb3-137"><a href="#cb3-137"></a>        <span class="st">"""</span></span>
<span id="cb3-138"><a href="#cb3-138"></a><span class="st">        This demo illustrates a combination of plotting and animation with</span></span>
<span id="cb3-139"><a href="#cb3-139"></a><span class="st">Streamlit. We're generating a bunch of random numbers in a loop for around</span></span>
<span id="cb3-140"><a href="#cb3-140"></a><span class="st">5 seconds. Enjoy!</span></span>
<span id="cb3-141"><a href="#cb3-141"></a><span class="st">"""</span></span>
<span id="cb3-142"><a href="#cb3-142"></a>    )</span>
<span id="cb3-143"><a href="#cb3-143"></a></span>
<span id="cb3-144"><a href="#cb3-144"></a>    progress_bar <span class="op">=</span> st.sidebar.progress(<span class="dv">0</span>)</span>
<span id="cb3-145"><a href="#cb3-145"></a>    status_text <span class="op">=</span> st.sidebar.empty()</span>
<span id="cb3-146"><a href="#cb3-146"></a>    last_rows <span class="op">=</span> np.random.randn(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb3-147"><a href="#cb3-147"></a>    chart <span class="op">=</span> st.line_chart(last_rows)</span>
<span id="cb3-148"><a href="#cb3-148"></a></span>
<span id="cb3-149"><a href="#cb3-149"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">101</span>):</span>
<span id="cb3-150"><a href="#cb3-150"></a>        new_rows <span class="op">=</span> last_rows[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">+</span> np.random.randn(<span class="dv">5</span>, <span class="dv">1</span>).cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-151"><a href="#cb3-151"></a>        status_text.text(<span class="st">"</span><span class="sc">%i%%</span><span class="st"> Complete"</span> <span class="op">%</span> i)</span>
<span id="cb3-152"><a href="#cb3-152"></a>        chart.add_rows(new_rows)</span>
<span id="cb3-153"><a href="#cb3-153"></a>        progress_bar.progress(i)</span>
<span id="cb3-154"><a href="#cb3-154"></a>        last_rows <span class="op">=</span> new_rows</span>
<span id="cb3-155"><a href="#cb3-155"></a>        time.sleep(<span class="fl">0.05</span>)</span>
<span id="cb3-156"><a href="#cb3-156"></a></span>
<span id="cb3-157"><a href="#cb3-157"></a>    progress_bar.empty()</span>
<span id="cb3-158"><a href="#cb3-158"></a></span>
<span id="cb3-159"><a href="#cb3-159"></a>    <span class="co"># Streamlit widgets automatically run the script from top to bottom. Since</span></span>
<span id="cb3-160"><a href="#cb3-160"></a>    <span class="co"># this button is not connected to any other logic, it just causes a plain</span></span>
<span id="cb3-161"><a href="#cb3-161"></a>    <span class="co"># rerun.</span></span>
<span id="cb3-162"><a href="#cb3-162"></a>    st.button(<span class="st">"Re-run"</span>)</span>
<span id="cb3-163"><a href="#cb3-163"></a></span>
<span id="cb3-164"><a href="#cb3-164"></a></span>
<span id="cb3-165"><a href="#cb3-165"></a><span class="kw">def</span> data_frame_demo():</span>
<span id="cb3-166"><a href="#cb3-166"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-167"><a href="#cb3-167"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-168"><a href="#cb3-168"></a>    <span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb3-169"><a href="#cb3-169"></a></span>
<span id="cb3-170"><a href="#cb3-170"></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb3-171"><a href="#cb3-171"></a></span>
<span id="cb3-172"><a href="#cb3-172"></a>    st.markdown(<span class="st">"# DataFrame Demo"</span>)</span>
<span id="cb3-173"><a href="#cb3-173"></a>    st.write(</span>
<span id="cb3-174"><a href="#cb3-174"></a>        <span class="st">"""</span></span>
<span id="cb3-175"><a href="#cb3-175"></a><span class="st">        This demo shows how to use `st.write` to visualize Pandas DataFrames.</span></span>
<span id="cb3-176"><a href="#cb3-176"></a></span>
<span id="cb3-177"><a href="#cb3-177"></a><span class="st">(Data courtesy of the [UN Data Explorer](http://data.un.org/Explorer.aspx).)</span></span>
<span id="cb3-178"><a href="#cb3-178"></a><span class="st">"""</span></span>
<span id="cb3-179"><a href="#cb3-179"></a>    )</span>
<span id="cb3-180"><a href="#cb3-180"></a></span>
<span id="cb3-181"><a href="#cb3-181"></a>    <span class="at">@st.cache_data</span></span>
<span id="cb3-182"><a href="#cb3-182"></a>    <span class="kw">def</span> get_UN_data():</span>
<span id="cb3-183"><a href="#cb3-183"></a>        AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb3-184"><a href="#cb3-184"></a>        df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb3-185"><a href="#cb3-185"></a>        <span class="cf">return</span> df.set_index(<span class="st">"Region"</span>)</span>
<span id="cb3-186"><a href="#cb3-186"></a></span>
<span id="cb3-187"><a href="#cb3-187"></a>    <span class="cf">try</span>:</span>
<span id="cb3-188"><a href="#cb3-188"></a>        df <span class="op">=</span> get_UN_data()</span>
<span id="cb3-189"><a href="#cb3-189"></a>        countries <span class="op">=</span> st.multiselect(</span>
<span id="cb3-190"><a href="#cb3-190"></a>            <span class="st">"Choose countries"</span>, <span class="bu">list</span>(df.index), [<span class="st">"China"</span>, <span class="st">"United States of America"</span>]</span>
<span id="cb3-191"><a href="#cb3-191"></a>        )</span>
<span id="cb3-192"><a href="#cb3-192"></a>        <span class="cf">if</span> <span class="kw">not</span> countries:</span>
<span id="cb3-193"><a href="#cb3-193"></a>            st.error(<span class="st">"Please select at least one country."</span>)</span>
<span id="cb3-194"><a href="#cb3-194"></a>        <span class="cf">else</span>:</span>
<span id="cb3-195"><a href="#cb3-195"></a>            data <span class="op">=</span> df.loc[countries]</span>
<span id="cb3-196"><a href="#cb3-196"></a>            data <span class="op">/=</span> <span class="fl">1000000.0</span></span>
<span id="cb3-197"><a href="#cb3-197"></a>            st.write(<span class="st">"### Gross Agricultural Production ($B)"</span>)</span>
<span id="cb3-198"><a href="#cb3-198"></a></span>
<span id="cb3-199"><a href="#cb3-199"></a>            <span class="co">#print pandas dataframe as a nicely formatted table (kable)</span></span>
<span id="cb3-200"><a href="#cb3-200"></a>            st.write(data.sort_index())</span>
<span id="cb3-201"><a href="#cb3-201"></a></span>
<span id="cb3-202"><a href="#cb3-202"></a>            data <span class="op">=</span> data.T.reset_index()</span>
<span id="cb3-203"><a href="#cb3-203"></a>            data <span class="op">=</span> pd.melt(data, id_vars<span class="op">=</span>[<span class="st">"index"</span>]).rename(</span>
<span id="cb3-204"><a href="#cb3-204"></a>                columns<span class="op">=</span>{<span class="st">"index"</span>: <span class="st">"year"</span>, <span class="st">"value"</span>: <span class="st">"Gross Agricultural Product ($B)"</span>}</span>
<span id="cb3-205"><a href="#cb3-205"></a>            )</span>
<span id="cb3-206"><a href="#cb3-206"></a>            chart <span class="op">=</span> (</span>
<span id="cb3-207"><a href="#cb3-207"></a>                alt.Chart(data)</span>
<span id="cb3-208"><a href="#cb3-208"></a>                .mark_area(opacity<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-209"><a href="#cb3-209"></a>                .encode(</span>
<span id="cb3-210"><a href="#cb3-210"></a>                    x<span class="op">=</span><span class="st">"year:T"</span>,</span>
<span id="cb3-211"><a href="#cb3-211"></a>                    y<span class="op">=</span>alt.Y(<span class="st">"Gross Agricultural Product ($B):Q"</span>, stack<span class="op">=</span><span class="va">None</span>),</span>
<span id="cb3-212"><a href="#cb3-212"></a>                    color<span class="op">=</span><span class="st">"Region:N"</span>,</span>
<span id="cb3-213"><a href="#cb3-213"></a>                )</span>
<span id="cb3-214"><a href="#cb3-214"></a>            )</span>
<span id="cb3-215"><a href="#cb3-215"></a>            st.altair_chart(chart, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-216"><a href="#cb3-216"></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb3-217"><a href="#cb3-217"></a>        st.error(</span>
<span id="cb3-218"><a href="#cb3-218"></a>            <span class="st">"""</span></span>
<span id="cb3-219"><a href="#cb3-219"></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb3-220"><a href="#cb3-220"></a></span>
<span id="cb3-221"><a href="#cb3-221"></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb3-222"><a href="#cb3-222"></a><span class="st">        """</span></span>
<span id="cb3-223"><a href="#cb3-223"></a>            <span class="op">%</span> e.reason</span>
<span id="cb3-224"><a href="#cb3-224"></a>        )</span>
<span id="cb3-225"><a href="#cb3-225"></a></span>
<span id="cb3-226"><a href="#cb3-226"></a>page_names_to_funcs <span class="op">=</span> {</span>
<span id="cb3-227"><a href="#cb3-227"></a>    <span class="st">"‚Äî"</span>: intro,</span>
<span id="cb3-228"><a href="#cb3-228"></a>    <span class="st">"Plotting Demo"</span>: plotting_demo,</span>
<span id="cb3-229"><a href="#cb3-229"></a>    <span class="st">"Mapping Demo"</span>: mapping_demo,</span>
<span id="cb3-230"><a href="#cb3-230"></a>    <span class="st">"DataFrame Demo"</span>: data_frame_demo</span>
<span id="cb3-231"><a href="#cb3-231"></a>}</span>
<span id="cb3-232"><a href="#cb3-232"></a></span>
<span id="cb3-233"><a href="#cb3-233"></a>demo_name <span class="op">=</span> st.sidebar.selectbox(<span class="st">"Choose a demo"</span>, page_names_to_funcs.keys())</span>
<span id="cb3-234"><a href="#cb3-234"></a>page_names_to_funcs[demo_name]()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>Have app up on on side and the code on the other.</li>
<li>Scroll through and note that there are 4 functions ‚Äì intro(), mapping_demo(), plotting_demo(), and data_frame_demo().</li>
<li>Walk through intro() function. Point to all the ‚Äúst.‚Äù methods and what they align with in the dashboard</li>
<li>Scroll all the way down to where the dictionary page_names_to_funcs is defined. Point to the options in the dropdown menu.
<ul>
<li>keys: strings shown to user</li>
<li>values: function objects ‚Äì NOT function calls. intro as opposed to intro(), plotting_demo as opposed to plotting_demo(), etc.</li>
<li><code>page_names_to_funcs[demo_name]()</code> is doing a ‚Äúfunction dispatch via a dictionary‚Äù. Basically, it says, look up which function corresponds to this select page name, and then run that function.</li>
</ul></li>
</ul>
<p>Equivalent to:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">if</span> demo_name <span class="op">==</span> <span class="st">"Plotting Demo"</span>:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    plotting_demo()</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">elif</span> demo_name <span class="op">==</span> <span class="st">"Mapping Demo"</span>:</span>
<span id="cb4-4"><a href="#cb4-4"></a>    mapping_demo()</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="cf">elif</span> demo_name <span class="op">==</span> <span class="st">"DataFrame Demo"</span>:</span>
<span id="cb4-6"><a href="#cb4-6"></a>    data_frame_demo()</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="cf">else</span>:</span>
<span id="cb4-8"><a href="#cb4-8"></a>    intro()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="feature-taking-input" class="slide level2">
<h2>Feature: taking input</h2>
<p>Streamlit has a huge number of different ways to take <a href="https://docs.streamlit.io/develop/api-reference/widgets">input</a>. In this lecture you will see:</p>
<ul>
<li><code>st.button()</code></li>
<li><code>st.checkbox()</code></li>
<li><code>st.slider()</code></li>
<li><code>st.selectbox()</code></li>
</ul>
</section>
<section id="feature-layouts-and-containers" class="slide level2">
<h2>Feature: layouts and containers</h2>
<p>Streamlit also has many <a href="https://docs.streamlit.io/develop/api-reference/layout">layouts and containers</a>. In this lecture you will see:</p>
<ul>
<li><code>st.sidebar()</code></li>
<li><code>st.columns()</code></li>
</ul>
</section>
<section id="feature-showing-progress" class="slide level2">
<h2>Feature: showing progress</h2>
<p>Streamlit also has ways to show progress and failure <a href="https://docs.streamlit.io/develop/api-reference/status">page</a>. In this lecture you will see:</p>
<ul>
<li><code>st.progress()</code></li>
<li><code>st.error()</code></li>
</ul>
</section>
<section id="plotting_demo" class="slide level2" style="font-size: 0.9em">
<h2><code>plotting_demo()</code></h2>
<ul>
<li><em>Lines 6-13</em>: use <code>st.</code> commands to set up page</li>
<li><em>Lines 15-18</em>: set up blank <code>progress_bar</code>, <code>status_text</code>, <code>chart</code> in sidebar</li>
<li><em>Lines 20-28</em>: (usual python) loop to generate random numbers</li>
</ul>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> plotting_demo():</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="im">import</span> time</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>    st.markdown(<span class="st">"# Plotting Demo"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>    st.write(</span>
<span id="cb5-8"><a href="#cb5-8"></a>        <span class="st">"""</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="st">        This demo illustrates a combination of plotting and animation with</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="st">Streamlit. We're generating a bunch of random numbers in a loop for around</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="st">5 seconds. Enjoy!</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="st">"""</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    )</span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>    progress_bar <span class="op">=</span> st.sidebar.progress(<span class="dv">0</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a>    status_text <span class="op">=</span> st.sidebar.empty()</span>
<span id="cb5-17"><a href="#cb5-17"></a>    last_rows <span class="op">=</span> np.random.randn(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a>    chart <span class="op">=</span> st.line_chart(last_rows)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">101</span>):</span>
<span id="cb5-21"><a href="#cb5-21"></a>        new_rows <span class="op">=</span> last_rows[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">+</span> np.random.randn(<span class="dv">5</span>, <span class="dv">1</span>).cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb5-22"><a href="#cb5-22"></a>        status_text.text(<span class="st">"</span><span class="sc">%i%%</span><span class="st"> Complete"</span> <span class="op">%</span> i)</span>
<span id="cb5-23"><a href="#cb5-23"></a>        chart.add_rows(new_rows)</span>
<span id="cb5-24"><a href="#cb5-24"></a>        progress_bar.progress(i)</span>
<span id="cb5-25"><a href="#cb5-25"></a>        last_rows <span class="op">=</span> new_rows</span>
<span id="cb5-26"><a href="#cb5-26"></a>        time.sleep(<span class="fl">0.05</span>)</span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a>    progress_bar.empty()</span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a>    <span class="co"># Streamlit widgets automatically run the script from top to bottom. Since</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="co"># this button is not connected to any other logic, it just causes a plain</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>    <span class="co"># rerun.</span></span>
<span id="cb5-33"><a href="#cb5-33"></a>    st.button(<span class="st">"Re-run"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>In the static visualization lectures we mentioned vega-lite without explaining really how you would use it. Now you can see how it is used which is that Streamlit is going to write Vega-Lite for us</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dataframe-demo-data-preview" class="slide level2">
<h2>DataFrame demo data preview</h2>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">def</span> get_UN_data():</span>
<span id="cb6-3"><a href="#cb6-3"></a>    AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>    df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>get_UN_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>1961</th>
      <th>1962</th>
      <th>1963</th>
      <th>1964</th>
      <th>1965</th>
      <th>1966</th>
      <th>1967</th>
      <th>1968</th>
      <th>1969</th>
      <th>...</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>58340740.0</td>
      <td>60690860.0</td>
      <td>63942700.0</td>
      <td>68462610.0</td>
      <td>74747900.0</td>
      <td>80445930.0</td>
      <td>81718660.0</td>
      <td>81474800.0</td>
      <td>82195340.0</td>
      <td>...</td>
      <td>295117400.0</td>
      <td>304490200.0</td>
      <td>315511100.0</td>
      <td>322771800.0</td>
      <td>336394800.0</td>
      <td>340623800.0</td>
      <td>360834700.0</td>
      <td>371939300.0</td>
      <td>380320200.0</td>
      <td>386448200.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>United States of America</td>
      <td>89816580.0</td>
      <td>90275010.0</td>
      <td>93700380.0</td>
      <td>94323650.0</td>
      <td>97704050.0</td>
      <td>97277180.0</td>
      <td>101177900.0</td>
      <td>103420600.0</td>
      <td>104285200.0</td>
      <td>...</td>
      <td>167311700.0</td>
      <td>170083400.0</td>
      <td>173640200.0</td>
      <td>170755800.0</td>
      <td>167494400.0</td>
      <td>172458200.0</td>
      <td>183519100.0</td>
      <td>181432900.0</td>
      <td>176803000.0</td>
      <td>184698800.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>50142680.0</td>
      <td>50015760.0</td>
      <td>51367730.0</td>
      <td>52267720.0</td>
      <td>49498330.0</td>
      <td>49309560.0</td>
      <td>52731470.0</td>
      <td>55208160.0</td>
      <td>56970870.0</td>
      <td>...</td>
      <td>137406600.0</td>
      <td>143567200.0</td>
      <td>142989200.0</td>
      <td>147351100.0</td>
      <td>137112300.0</td>
      <td>151552000.0</td>
      <td>149552600.0</td>
      <td>156869200.0</td>
      <td>164974800.0</td>
      <td>175747700.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USSR</td>
      <td>72768810.0</td>
      <td>73961920.0</td>
      <td>70531000.0</td>
      <td>81216890.0</td>
      <td>80941960.0</td>
      <td>90781310.0</td>
      <td>92659220.0</td>
      <td>98507460.0</td>
      <td>93745540.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brazil</td>
      <td>16564600.0</td>
      <td>17344940.0</td>
      <td>17443010.0</td>
      <td>17658130.0</td>
      <td>20367240.0</td>
      <td>19238750.0</td>
      <td>20650260.0</td>
      <td>21256810.0</td>
      <td>22008700.0</td>
      <td>...</td>
      <td>60706480.0</td>
      <td>65353180.0</td>
      <td>67416260.0</td>
      <td>71250310.0</td>
      <td>75603330.0</td>
      <td>81198510.0</td>
      <td>85626940.0</td>
      <td>87363190.0</td>
      <td>85319580.0</td>
      <td>90075170.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>215</th>
      <td>Tuvalu</td>
      <td>473.0</td>
      <td>474.0</td>
      <td>476.0</td>
      <td>513.0</td>
      <td>514.0</td>
      <td>515.0</td>
      <td>467.0</td>
      <td>438.0</td>
      <td>400.0</td>
      <td>...</td>
      <td>466.0</td>
      <td>480.0</td>
      <td>482.0</td>
      <td>500.0</td>
      <td>511.0</td>
      <td>528.0</td>
      <td>541.0</td>
      <td>541.0</td>
      <td>541.0</td>
      <td>558.0</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Nauru</td>
      <td>184.0</td>
      <td>184.0</td>
      <td>185.0</td>
      <td>191.0</td>
      <td>212.0</td>
      <td>213.0</td>
      <td>218.0</td>
      <td>219.0</td>
      <td>233.0</td>
      <td>...</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>349.0</td>
      <td>379.0</td>
    </tr>
    <tr>
      <th>217</th>
      <td>Tokelau</td>
      <td>170.0</td>
      <td>220.0</td>
      <td>112.0</td>
      <td>281.0</td>
      <td>256.0</td>
      <td>205.0</td>
      <td>184.0</td>
      <td>198.0</td>
      <td>198.0</td>
      <td>...</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
      <td>346.0</td>
    </tr>
    <tr>
      <th>218</th>
      <td>Cayman Islands</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>200.0</td>
      <td>202.0</td>
      <td>202.0</td>
      <td>206.0</td>
      <td>...</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>125.0</td>
      <td>127.0</td>
      <td>129.0</td>
    </tr>
    <tr>
      <th>219</th>
      <td>Saint Pierre and Miquelon</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>21.0</td>
      <td>21.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>28.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>24.0</td>
      <td>26.0</td>
      <td>23.0</td>
    </tr>
  </tbody>
</table>
<p>220 rows √ó 48 columns</p>
</div>
</div>
</div>
</section>
<section id="dataframe-demo-review-code" class="slide level2" style="font-size: 0.8em">
<h2>DataFrame demo review code</h2>
<ul>
<li><em>Lines 25-27</em>: choose inputs <code>countries = st.multiselect()</code></li>
<li><em>Line 36</em>: print table using <code>st.write()</code></li>
<li><em>Line 41-43</em>: <code>pd.melt</code> in prepartion for <code>chart</code></li>
</ul>
<p><code>data_frame_demo()</code> from <code>3/multipage.py</code>:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> data_frame_demo():</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>    st.markdown(<span class="st">"# DataFrame Demo"</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>    st.write(</span>
<span id="cb8-10"><a href="#cb8-10"></a>        <span class="st">"""</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="st">        This demo shows how to use `st.write` to visualize Pandas DataFrames.</span></span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="st">(Data courtesy of the [UN Data Explorer](http://data.un.org/Explorer.aspx).)</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="st">"""</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    )</span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="at">@st.cache_data</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="kw">def</span> get_UN_data():</span>
<span id="cb8-19"><a href="#cb8-19"></a>        AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>        df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb8-21"><a href="#cb8-21"></a>        <span class="cf">return</span> df.set_index(<span class="st">"Region"</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="cf">try</span>:</span>
<span id="cb8-24"><a href="#cb8-24"></a>        df <span class="op">=</span> get_UN_data()</span>
<span id="cb8-25"><a href="#cb8-25"></a>        countries <span class="op">=</span> st.multiselect(</span>
<span id="cb8-26"><a href="#cb8-26"></a>            <span class="st">"Choose countries"</span>, <span class="bu">list</span>(df.index), [<span class="st">"China"</span>, <span class="st">"United States of America"</span>]</span>
<span id="cb8-27"><a href="#cb8-27"></a>        )</span>
<span id="cb8-28"><a href="#cb8-28"></a>        <span class="cf">if</span> <span class="kw">not</span> countries:</span>
<span id="cb8-29"><a href="#cb8-29"></a>            st.error(<span class="st">"Please select at least one country."</span>)</span>
<span id="cb8-30"><a href="#cb8-30"></a>        <span class="cf">else</span>:</span>
<span id="cb8-31"><a href="#cb8-31"></a>            data <span class="op">=</span> df.loc[countries]</span>
<span id="cb8-32"><a href="#cb8-32"></a>            data <span class="op">/=</span> <span class="fl">1000000.0</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>            st.write(<span class="st">"### Gross Agricultural Production ($B)"</span>)</span>
<span id="cb8-34"><a href="#cb8-34"></a></span>
<span id="cb8-35"><a href="#cb8-35"></a>            <span class="co">#print pandas dataframe as a nicely formatted table (kable)</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>            st.write(data.sort_index())</span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a>            data <span class="op">=</span> data.T.reset_index()</span>
<span id="cb8-39"><a href="#cb8-39"></a>            data <span class="op">=</span> pd.melt(data, id_vars<span class="op">=</span>[<span class="st">"index"</span>]).rename(</span>
<span id="cb8-40"><a href="#cb8-40"></a>                columns<span class="op">=</span>{<span class="st">"index"</span>: <span class="st">"year"</span>, <span class="st">"value"</span>: <span class="st">"Gross Agricultural Product ($B)"</span>}</span>
<span id="cb8-41"><a href="#cb8-41"></a>            )</span>
<span id="cb8-42"><a href="#cb8-42"></a>            chart <span class="op">=</span> (</span>
<span id="cb8-43"><a href="#cb8-43"></a>                alt.Chart(data)</span>
<span id="cb8-44"><a href="#cb8-44"></a>                .mark_area(opacity<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb8-45"><a href="#cb8-45"></a>                .encode(</span>
<span id="cb8-46"><a href="#cb8-46"></a>                    x<span class="op">=</span><span class="st">"year:T"</span>,</span>
<span id="cb8-47"><a href="#cb8-47"></a>                    y<span class="op">=</span>alt.Y(<span class="st">"Gross Agricultural Product ($B):Q"</span>, stack<span class="op">=</span><span class="va">None</span>),</span>
<span id="cb8-48"><a href="#cb8-48"></a>                    color<span class="op">=</span><span class="st">"Region:N"</span>,</span>
<span id="cb8-49"><a href="#cb8-49"></a>                )</span>
<span id="cb8-50"><a href="#cb8-50"></a>            )</span>
<span id="cb8-51"><a href="#cb8-51"></a>            st.altair_chart(chart, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-52"><a href="#cb8-52"></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb8-53"><a href="#cb8-53"></a>        st.error(</span>
<span id="cb8-54"><a href="#cb8-54"></a>            <span class="st">"""</span></span>
<span id="cb8-55"><a href="#cb8-55"></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb8-56"><a href="#cb8-56"></a></span>
<span id="cb8-57"><a href="#cb8-57"></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="st">        """</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>            <span class="op">%</span> e.reason</span>
<span id="cb8-60"><a href="#cb8-60"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-showing-output" class="slide level2">
<h2>Feature: showing output</h2>
<p><em>for text</em></p>
<p><code>st.markdown()</code></p>
<p><em>for anything</em></p>
<p><code>st.write()</code></p>
<ul>
<li>In this example, <code>st.write()</code> is used to make a table (analogous to <code>print()</code> or <code>head()</code>)</li>
<li>Useful tip: <code>st.write()</code> is Streamlit‚Äôs ‚ÄúSwiss Army knife‚Äù. Pass almost anything: latex, Matplotlib figures, Altair charts, multiple arguments, and more. Don‚Äôt worry, Streamlit will figure it out and render things the right way. Full list <a href="https://docs.streamlit.io/develop/api-reference/write-magic/st.write">here</a></li>
</ul>
</section>
<section id="mapping-demo-data-preview" class="slide level2" style="font-size: 0.8em">
<h2>Mapping demo data preview</h2>
<ul>
<li>Runs on <a href="https://deckgl.readthedocs.io/en/latest/"><code>pydeck</code></a> (‚ÄúHigh-scale spatial rendering‚Äù).</li>
<li>Makes gorgeous maps (will have more depth in minilesson).</li>
<li>In Terminal/command line: update conda environment or <code>$ pip install pydeck</code></li>
</ul>
<table>
<thead>
<tr class="header">
<th>data preview</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bike_rental_stats.json">bike_rental_stats</a></td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
</tr>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_path_stats.json">bart_path_stats</a></td>
</tr>
</tbody>
</table>
</section>
<section id="mapping-demo-review-code" class="slide level2">
<h2>mapping demo review code</h2>
<p>Review <code>HexagonLayer</code>, <code>ScatterplotLayer</code>, <code>TextLayer</code>, <code>ArcLayer</code></p>
<p><code>mapping_demo()</code> from <code>3/multipage.py</code>:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> mapping_demo():</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>    st.markdown(<span class="st">"# Mapping Demo"</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>    st.write(</span>
<span id="cb9-10"><a href="#cb9-10"></a>        <span class="st">"""</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="st">        This demo shows how to use</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="st">[`st.pydeck_chart`](https://docs.streamlit.io/develop/api-reference/charts/st.pydeck_chart)</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="st">to display geospatial data.</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="st">"""</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    )</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="at">@st.cache_data</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="kw">def</span> from_data_file(filename):</span>
<span id="cb9-19"><a href="#cb9-19"></a>        url <span class="op">=</span> (</span>
<span id="cb9-20"><a href="#cb9-20"></a>            <span class="st">"http://raw.githubusercontent.com/streamlit/"</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>            <span class="st">"example-data/master/hello/v1/</span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> filename</span>
<span id="cb9-22"><a href="#cb9-22"></a>        )</span>
<span id="cb9-23"><a href="#cb9-23"></a>        <span class="cf">return</span> pd.read_json(url)</span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a>    <span class="cf">try</span>:</span>
<span id="cb9-26"><a href="#cb9-26"></a>        ALL_LAYERS <span class="op">=</span> {</span>
<span id="cb9-27"><a href="#cb9-27"></a>            <span class="st">"Bike Rentals"</span>: pdk.Layer(</span>
<span id="cb9-28"><a href="#cb9-28"></a>                <span class="st">"HexagonLayer"</span>,</span>
<span id="cb9-29"><a href="#cb9-29"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bike_rental_stats.json"</span>),</span>
<span id="cb9-30"><a href="#cb9-30"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb9-31"><a href="#cb9-31"></a>                radius<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb9-32"><a href="#cb9-32"></a>                elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb9-33"><a href="#cb9-33"></a>                elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb9-34"><a href="#cb9-34"></a>                extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-35"><a href="#cb9-35"></a>            ),</span>
<span id="cb9-36"><a href="#cb9-36"></a>            <span class="st">"Bart Stop Exits"</span>: pdk.Layer(</span>
<span id="cb9-37"><a href="#cb9-37"></a>                <span class="st">"ScatterplotLayer"</span>,</span>
<span id="cb9-38"><a href="#cb9-38"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb9-39"><a href="#cb9-39"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb9-40"><a href="#cb9-40"></a>                get_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb9-41"><a href="#cb9-41"></a>                get_radius<span class="op">=</span><span class="st">"[exits]"</span>,</span>
<span id="cb9-42"><a href="#cb9-42"></a>                radius_scale<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb9-43"><a href="#cb9-43"></a>            ),</span>
<span id="cb9-44"><a href="#cb9-44"></a>            <span class="st">"Bart Stop Names"</span>: pdk.Layer(</span>
<span id="cb9-45"><a href="#cb9-45"></a>                <span class="st">"TextLayer"</span>,</span>
<span id="cb9-46"><a href="#cb9-46"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb9-47"><a href="#cb9-47"></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb9-48"><a href="#cb9-48"></a>                get_text<span class="op">=</span><span class="st">"name"</span>,</span>
<span id="cb9-49"><a href="#cb9-49"></a>                get_color<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">200</span>],</span>
<span id="cb9-50"><a href="#cb9-50"></a>                get_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb9-51"><a href="#cb9-51"></a>                get_alignment_baseline<span class="op">=</span><span class="st">"'bottom'"</span>,</span>
<span id="cb9-52"><a href="#cb9-52"></a>            ),</span>
<span id="cb9-53"><a href="#cb9-53"></a>            <span class="st">"Outbound Flow"</span>: pdk.Layer(</span>
<span id="cb9-54"><a href="#cb9-54"></a>                <span class="st">"ArcLayer"</span>,</span>
<span id="cb9-55"><a href="#cb9-55"></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_path_stats.json"</span>),</span>
<span id="cb9-56"><a href="#cb9-56"></a>                get_source_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb9-57"><a href="#cb9-57"></a>                get_target_position<span class="op">=</span>[<span class="st">"lon2"</span>, <span class="st">"lat2"</span>],</span>
<span id="cb9-58"><a href="#cb9-58"></a>                get_source_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb9-59"><a href="#cb9-59"></a>                get_target_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb9-60"><a href="#cb9-60"></a>                auto_highlight<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-61"><a href="#cb9-61"></a>                width_scale<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span id="cb9-62"><a href="#cb9-62"></a>                get_width<span class="op">=</span><span class="st">"outbound"</span>,</span>
<span id="cb9-63"><a href="#cb9-63"></a>                width_min_pixels<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb9-64"><a href="#cb9-64"></a>                width_max_pixels<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb9-65"><a href="#cb9-65"></a>            ),</span>
<span id="cb9-66"><a href="#cb9-66"></a>        }</span>
<span id="cb9-67"><a href="#cb9-67"></a>        st.sidebar.markdown(<span class="st">"### Map Layers"</span>)</span>
<span id="cb9-68"><a href="#cb9-68"></a>        selected_layers <span class="op">=</span> [</span>
<span id="cb9-69"><a href="#cb9-69"></a>            layer</span>
<span id="cb9-70"><a href="#cb9-70"></a>            <span class="cf">for</span> layer_name, layer <span class="kw">in</span> ALL_LAYERS.items()</span>
<span id="cb9-71"><a href="#cb9-71"></a>            <span class="cf">if</span> st.sidebar.checkbox(layer_name, <span class="va">True</span>)</span>
<span id="cb9-72"><a href="#cb9-72"></a>        ]</span>
<span id="cb9-73"><a href="#cb9-73"></a>        <span class="cf">if</span> selected_layers:</span>
<span id="cb9-74"><a href="#cb9-74"></a>            st.pydeck_chart(</span>
<span id="cb9-75"><a href="#cb9-75"></a>                pdk.Deck(</span>
<span id="cb9-76"><a href="#cb9-76"></a>                    map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb9-77"><a href="#cb9-77"></a>                    initial_view_state<span class="op">=</span>{</span>
<span id="cb9-78"><a href="#cb9-78"></a>                        <span class="st">"latitude"</span>: <span class="fl">37.76</span>,</span>
<span id="cb9-79"><a href="#cb9-79"></a>                        <span class="st">"longitude"</span>: <span class="op">-</span><span class="fl">122.4</span>,</span>
<span id="cb9-80"><a href="#cb9-80"></a>                        <span class="st">"zoom"</span>: <span class="dv">11</span>,</span>
<span id="cb9-81"><a href="#cb9-81"></a>                        <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb9-82"><a href="#cb9-82"></a>                    },</span>
<span id="cb9-83"><a href="#cb9-83"></a>                    layers<span class="op">=</span>selected_layers,</span>
<span id="cb9-84"><a href="#cb9-84"></a>                )</span>
<span id="cb9-85"><a href="#cb9-85"></a>            )</span>
<span id="cb9-86"><a href="#cb9-86"></a>        <span class="cf">else</span>:</span>
<span id="cb9-87"><a href="#cb9-87"></a>            st.error(<span class="st">"Please choose at least one layer above."</span>)</span>
<span id="cb9-88"><a href="#cb9-88"></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb9-89"><a href="#cb9-89"></a>        st.error(</span>
<span id="cb9-90"><a href="#cb9-90"></a>            <span class="st">"""</span></span>
<span id="cb9-91"><a href="#cb9-91"></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb9-92"><a href="#cb9-92"></a></span>
<span id="cb9-93"><a href="#cb9-93"></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb9-94"><a href="#cb9-94"></a><span class="st">        """</span></span>
<span id="cb9-95"><a href="#cb9-95"></a>            <span class="op">%</span> e.reason</span>
<span id="cb9-96"><a href="#cb9-96"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="optional-summarize-how-each-dataset-is-used" class="slide level2" style="font-size: 0.8em">
<h2>(Optional) Summarize how each dataset is used</h2>
<table>
<thead>
<tr class="header">
<th>Data preview</th>
<th>Layer name</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bike_rental_stats.json">bike_rental_stats</a></td>
<td><code>HexagonLayer</code></td>
<td>bar height set by number of rentals at each lat lon</td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
<td><code>ScatterplotLayer</code></td>
<td>radius = <code>exits</code></td>
</tr>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
<td><code>TextLayer</code></td>
<td><code>get_text="name"</code></td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_path_stats.json">bart_path_stats</a></td>
<td><code>ArcLayer</code></td>
<td>arcs via <code>get_source_position = ["lon", "lat"], get_target_position = ["lon2", "lat2"]</code></td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>Not sure we will need to talk about this. only cover it if people are confused from looking at the code itself.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="control-flow-what-code-exactly-does-streamlit-run" class="slide level2">
<h2>Control flow: what code exactly does streamlit run?</h2>
<p>Streamlit tries to run your code like a normal python script.</p>
<p>If you write a function and never call it, it is not run. To understand what‚Äôs run here, the key code block is this</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>page_names_to_funcs <span class="op">=</span> {</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="st">"‚Äî"</span>: intro,</span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="st">"Plotting Demo"</span>: plotting_demo,</span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="st">"Mapping Demo"</span>: mapping_demo,</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="st">"DataFrame Demo"</span>: data_frame_demo</span>
<span id="cb10-6"><a href="#cb10-6"></a>}</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>demo_name <span class="op">=</span> st.sidebar.selectbox(<span class="st">"Choose a demo"</span>, page_names_to_funcs.keys())</span>
<span id="cb10-9"><a href="#cb10-9"></a>page_names_to_funcs[demo_name]()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="do-pair-share" class="slide level2" data-background-color="aliceblue">
<h2>do-pair-share</h2>
<ol type="1">
<li>Render dashboard code in student repo (<code>student30538-w26/lectures/dashboard/app_dps_1.py</code>) at the command line/Terminal: <code>$ streamlit run app_dps_1.py</code></li>
<li>Edit <code>.py</code> so that user can select multiple items instead of just one: display Bus routes, L routes, or both in sidebar</li>
<li>Re-render</li>
</ol>
<p><em>Hint: browse through documentation for <a href="https://docs.streamlit.io/develop/api-reference/widgets">input options</a> </em></p>
</section>
<section id="uber-pickups-a-full-fledged-dashboard" class="slide level2">
<h2>Uber pickups: a full-fledged dashboard</h2>
<p><a href="http://uchicago-harris-dap-dashboards-4.streamlit.app/">http://uchicago-harris-dap-dashboards-4.streamlit.app/</a></p>
<ul>
<li>This is the ‚Äúclassic‚Äù Streamlit dashboard (the one they use in all the demos)</li>
<li>Why? Pretty, adapts nicely to user input, and it showcases integration with <code>pydeck</code> and <code>altair</code>.</li>
</ul>
</section>
<section id="uber-pickups-preview-data" class="slide level2">
<h2>Uber pickups: preview data</h2>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> os</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">def</span> load_data():</span>
<span id="cb11-3"><a href="#cb11-3"></a>    path <span class="op">=</span> <span class="st">"uber-raw-data-sep14.csv.gz"</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(path):</span>
<span id="cb11-5"><a href="#cb11-5"></a>        path <span class="op">=</span> <span class="ss">f"https://github.com/streamlit/demo-uber-nyc-pickups/raw/main/</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>    data <span class="op">=</span> pd.read_csv(</span>
<span id="cb11-8"><a href="#cb11-8"></a>        path,</span>
<span id="cb11-9"><a href="#cb11-9"></a>        nrows<span class="op">=</span><span class="dv">6</span>,  </span>
<span id="cb11-10"><a href="#cb11-10"></a>        names<span class="op">=</span>[</span>
<span id="cb11-11"><a href="#cb11-11"></a>            <span class="st">"date/time"</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>            <span class="st">"lat"</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>            <span class="st">"lon"</span>,</span>
<span id="cb11-14"><a href="#cb11-14"></a>        ],  <span class="co"># specify names directly since they don't change</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>        skiprows<span class="op">=</span><span class="dv">1</span>,  <span class="co"># don't read header since names specified directly</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>        usecols<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],  <span class="co"># doesn't load last column, constant value "B02512"</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>        parse_dates<span class="op">=</span>[</span>
<span id="cb11-18"><a href="#cb11-18"></a>            <span class="st">"date/time"</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>        ],  <span class="co"># set as datetime instead of converting after the fact</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>    )</span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a>    <span class="cf">return</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>load_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date/time</th>
      <th>lat</th>
      <th>lon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-09-01 00:01:00</td>
      <td>40.2201</td>
      <td>-74.0021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-09-01 00:01:00</td>
      <td>40.7500</td>
      <td>-74.0027</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-09-01 00:03:00</td>
      <td>40.7559</td>
      <td>-73.9864</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-09-01 00:06:00</td>
      <td>40.7450</td>
      <td>-73.9889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-09-01 00:11:00</td>
      <td>40.8145</td>
      <td>-73.9444</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2014-09-01 00:12:00</td>
      <td>40.6735</td>
      <td>-73.9918</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="uber-pickups-review-code" class="slide level2" style="font-size: 0.7em">
<h2>Uber pickups review code</h2>
<ul>
<li><em>Lines 115-19</em>: user chooses time of day (<code>pickup_hour</code>)</li>
<li><em>Lines 69-70</em>: helper function <code>filterdata(data, hour_selected)</code></li>
<li><em>Lines 41, 140-157</em>: <code>map(data, lat, lon, zoom)</code> makes a PyDeck <code>HexagonLayer</code>. Repeat 4x.</li>
<li><em>Lines 170-182</em>: <code>histdata(df, hr)</code> makes an altair histogram with n rides</li>
</ul>
<p><code>4/uber_pickups.py</code>:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">"""An example of showing geographic data."""</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="im">import</span> os</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co"># SETTING PAGE CONFIG TO WIDE MODE AND ADDING A TITLE AND FAVICON</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>st.set_page_config(layout<span class="op">=</span><span class="st">"wide"</span>, page_title<span class="op">=</span><span class="st">"NYC Ridesharing Demo"</span>, page_icon<span class="op">=</span><span class="st">":taxi:"</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co"># LOAD DATA ONCE</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="at">@st.cache_data</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="kw">def</span> load_data():</span>
<span id="cb13-18"><a href="#cb13-18"></a>    path <span class="op">=</span> <span class="st">"uber-raw-data-sep14.csv.gz"</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(path):</span>
<span id="cb13-20"><a href="#cb13-20"></a>        path <span class="op">=</span> <span class="ss">f"https://github.com/streamlit/demo-uber-nyc-pickups/raw/main/</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb13-21"><a href="#cb13-21"></a></span>
<span id="cb13-22"><a href="#cb13-22"></a>    data <span class="op">=</span> pd.read_csv(</span>
<span id="cb13-23"><a href="#cb13-23"></a>        path,</span>
<span id="cb13-24"><a href="#cb13-24"></a>        nrows<span class="op">=</span><span class="dv">100000</span>,  <span class="co"># approx. 10% of data</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>        names<span class="op">=</span>[</span>
<span id="cb13-26"><a href="#cb13-26"></a>            <span class="st">"date/time"</span>,</span>
<span id="cb13-27"><a href="#cb13-27"></a>            <span class="st">"lat"</span>,</span>
<span id="cb13-28"><a href="#cb13-28"></a>            <span class="st">"lon"</span>,</span>
<span id="cb13-29"><a href="#cb13-29"></a>        ],  <span class="co"># specify names directly since they don't change</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>        skiprows<span class="op">=</span><span class="dv">1</span>,  <span class="co"># don't read header since names specified directly</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>        usecols<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],  <span class="co"># doesn't load last column, constant value "B02512"</span></span>
<span id="cb13-32"><a href="#cb13-32"></a>        parse_dates<span class="op">=</span>[</span>
<span id="cb13-33"><a href="#cb13-33"></a>            <span class="st">"date/time"</span></span>
<span id="cb13-34"><a href="#cb13-34"></a>        ],  <span class="co"># set as datetime instead of converting after the fact</span></span>
<span id="cb13-35"><a href="#cb13-35"></a>    )</span>
<span id="cb13-36"><a href="#cb13-36"></a></span>
<span id="cb13-37"><a href="#cb13-37"></a>    <span class="cf">return</span> data</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="co"># FUNCTION FOR AIRPORT MAPS</span></span>
<span id="cb13-41"><a href="#cb13-41"></a><span class="kw">def</span> <span class="bu">map</span>(data, lat, lon, zoom):</span>
<span id="cb13-42"><a href="#cb13-42"></a>    st.write(</span>
<span id="cb13-43"><a href="#cb13-43"></a>        pdk.Deck(</span>
<span id="cb13-44"><a href="#cb13-44"></a>            map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb13-45"><a href="#cb13-45"></a>            initial_view_state<span class="op">=</span>{</span>
<span id="cb13-46"><a href="#cb13-46"></a>                <span class="st">"latitude"</span>: lat,</span>
<span id="cb13-47"><a href="#cb13-47"></a>                <span class="st">"longitude"</span>: lon,</span>
<span id="cb13-48"><a href="#cb13-48"></a>                <span class="st">"zoom"</span>: zoom,</span>
<span id="cb13-49"><a href="#cb13-49"></a>                <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb13-50"><a href="#cb13-50"></a>            },</span>
<span id="cb13-51"><a href="#cb13-51"></a>            layers<span class="op">=</span>[</span>
<span id="cb13-52"><a href="#cb13-52"></a>                pdk.Layer(</span>
<span id="cb13-53"><a href="#cb13-53"></a>                    <span class="st">"HexagonLayer"</span>,</span>
<span id="cb13-54"><a href="#cb13-54"></a>                    data<span class="op">=</span>data,</span>
<span id="cb13-55"><a href="#cb13-55"></a>                    get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb13-56"><a href="#cb13-56"></a>                    radius<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb13-57"><a href="#cb13-57"></a>                    elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb13-58"><a href="#cb13-58"></a>                    elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb13-59"><a href="#cb13-59"></a>                    pickable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb13-60"><a href="#cb13-60"></a>                    extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb13-61"><a href="#cb13-61"></a>                ),</span>
<span id="cb13-62"><a href="#cb13-62"></a>            ],</span>
<span id="cb13-63"><a href="#cb13-63"></a>        )</span>
<span id="cb13-64"><a href="#cb13-64"></a>    )</span>
<span id="cb13-65"><a href="#cb13-65"></a></span>
<span id="cb13-66"><a href="#cb13-66"></a></span>
<span id="cb13-67"><a href="#cb13-67"></a><span class="co"># FILTER DATA FOR A SPECIFIC HOUR, CACHE</span></span>
<span id="cb13-68"><a href="#cb13-68"></a><span class="at">@st.cache_data</span></span>
<span id="cb13-69"><a href="#cb13-69"></a><span class="kw">def</span> filterdata(df, hour_selected):</span>
<span id="cb13-70"><a href="#cb13-70"></a>    <span class="cf">return</span> df[df[<span class="st">"date/time"</span>].dt.hour <span class="op">==</span> hour_selected]</span>
<span id="cb13-71"><a href="#cb13-71"></a></span>
<span id="cb13-72"><a href="#cb13-72"></a></span>
<span id="cb13-73"><a href="#cb13-73"></a><span class="co"># CALCULATE MIDPOINT FOR GIVEN SET OF DATA</span></span>
<span id="cb13-74"><a href="#cb13-74"></a><span class="at">@st.cache_data</span></span>
<span id="cb13-75"><a href="#cb13-75"></a><span class="kw">def</span> mpoint(lat, lon):</span>
<span id="cb13-76"><a href="#cb13-76"></a>    <span class="cf">return</span> (np.average(lat), np.average(lon))</span>
<span id="cb13-77"><a href="#cb13-77"></a></span>
<span id="cb13-78"><a href="#cb13-78"></a></span>
<span id="cb13-79"><a href="#cb13-79"></a><span class="co"># PLOT FILTERED DATA AS HISTOGRAM</span></span>
<span id="cb13-80"><a href="#cb13-80"></a><span class="at">@st.cache_data</span></span>
<span id="cb13-81"><a href="#cb13-81"></a><span class="kw">def</span> histdata(df, hr):</span>
<span id="cb13-82"><a href="#cb13-82"></a>    filtered <span class="op">=</span> data[</span>
<span id="cb13-83"><a href="#cb13-83"></a>        (df[<span class="st">"date/time"</span>].dt.hour <span class="op">&gt;=</span> hr) <span class="op">&amp;</span> (df[<span class="st">"date/time"</span>].dt.hour <span class="op">&lt;</span> (hr <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb13-84"><a href="#cb13-84"></a>    ]</span>
<span id="cb13-85"><a href="#cb13-85"></a></span>
<span id="cb13-86"><a href="#cb13-86"></a>    hist <span class="op">=</span> np.histogram(filtered[<span class="st">"date/time"</span>].dt.minute, bins<span class="op">=</span><span class="dv">60</span>, <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">60</span>))[<span class="dv">0</span>]</span>
<span id="cb13-87"><a href="#cb13-87"></a></span>
<span id="cb13-88"><a href="#cb13-88"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">"minute"</span>: <span class="bu">range</span>(<span class="dv">60</span>), <span class="st">"pickups"</span>: hist})</span>
<span id="cb13-89"><a href="#cb13-89"></a></span>
<span id="cb13-90"><a href="#cb13-90"></a></span>
<span id="cb13-91"><a href="#cb13-91"></a><span class="co"># STREAMLIT APP LAYOUT</span></span>
<span id="cb13-92"><a href="#cb13-92"></a>data <span class="op">=</span> load_data()</span>
<span id="cb13-93"><a href="#cb13-93"></a></span>
<span id="cb13-94"><a href="#cb13-94"></a><span class="co"># LAYING OUT THE TOP SECTION OF THE APP</span></span>
<span id="cb13-95"><a href="#cb13-95"></a>row1_1, row1_2 <span class="op">=</span> st.columns((<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb13-96"><a href="#cb13-96"></a></span>
<span id="cb13-97"><a href="#cb13-97"></a><span class="co"># SEE IF THERE'S A QUERY PARAM IN THE URL (e.g. ?pickup_hour=2)</span></span>
<span id="cb13-98"><a href="#cb13-98"></a><span class="co"># THIS ALLOWS YOU TO PASS A STATEFUL URL TO SOMEONE WITH A SPECIFIC HOUR SELECTED,</span></span>
<span id="cb13-99"><a href="#cb13-99"></a><span class="co"># E.G. https://share.streamlit.io/streamlit/demo-uber-nyc-pickups/main?pickup_hour=2</span></span>
<span id="cb13-100"><a href="#cb13-100"></a><span class="cf">if</span> <span class="kw">not</span> st.session_state.get(<span class="st">"url_synced"</span>, <span class="va">False</span>):</span>
<span id="cb13-101"><a href="#cb13-101"></a>    <span class="cf">try</span>:</span>
<span id="cb13-102"><a href="#cb13-102"></a>        pickup_hour <span class="op">=</span> <span class="bu">int</span>(st.query_params[<span class="st">"pickup_hour"</span>])</span>
<span id="cb13-103"><a href="#cb13-103"></a>        st.session_state[<span class="st">"pickup_hour"</span>] <span class="op">=</span> pickup_hour</span>
<span id="cb13-104"><a href="#cb13-104"></a>        st.session_state[<span class="st">"url_synced"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb13-105"><a href="#cb13-105"></a>    <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb13-106"><a href="#cb13-106"></a>        <span class="cf">pass</span></span>
<span id="cb13-107"><a href="#cb13-107"></a></span>
<span id="cb13-108"><a href="#cb13-108"></a></span>
<span id="cb13-109"><a href="#cb13-109"></a><span class="co"># IF THE SLIDER CHANGES, UPDATE THE QUERY PARAM</span></span>
<span id="cb13-110"><a href="#cb13-110"></a><span class="kw">def</span> update_query_params():</span>
<span id="cb13-111"><a href="#cb13-111"></a>    hour_selected <span class="op">=</span> st.session_state[<span class="st">"pickup_hour"</span>]</span>
<span id="cb13-112"><a href="#cb13-112"></a>    st.query_params[<span class="st">"pickup_hour"</span>] <span class="op">=</span> hour_selected</span>
<span id="cb13-113"><a href="#cb13-113"></a></span>
<span id="cb13-114"><a href="#cb13-114"></a></span>
<span id="cb13-115"><a href="#cb13-115"></a><span class="cf">with</span> row1_1:</span>
<span id="cb13-116"><a href="#cb13-116"></a>    st.title(<span class="st">"NYC Uber Ridesharing Data"</span>)</span>
<span id="cb13-117"><a href="#cb13-117"></a>    hour_selected <span class="op">=</span> st.slider(</span>
<span id="cb13-118"><a href="#cb13-118"></a>        <span class="st">"Select hour of pickup"</span>, <span class="dv">0</span>, <span class="dv">23</span>, key<span class="op">=</span><span class="st">"pickup_hour"</span>, on_change<span class="op">=</span>update_query_params</span>
<span id="cb13-119"><a href="#cb13-119"></a>    )</span>
<span id="cb13-120"><a href="#cb13-120"></a></span>
<span id="cb13-121"><a href="#cb13-121"></a></span>
<span id="cb13-122"><a href="#cb13-122"></a><span class="cf">with</span> row1_2:</span>
<span id="cb13-123"><a href="#cb13-123"></a>    st.write(</span>
<span id="cb13-124"><a href="#cb13-124"></a>        <span class="st">"""</span></span>
<span id="cb13-125"><a href="#cb13-125"></a><span class="st">    ##</span></span>
<span id="cb13-126"><a href="#cb13-126"></a><span class="st">    Examining how Uber pickups vary over time in New York City's and at its major regional airports.</span></span>
<span id="cb13-127"><a href="#cb13-127"></a><span class="st">    By sliding the slider on the left you can view different slices of time and explore different transportation trends.</span></span>
<span id="cb13-128"><a href="#cb13-128"></a><span class="st">    """</span></span>
<span id="cb13-129"><a href="#cb13-129"></a>    )</span>
<span id="cb13-130"><a href="#cb13-130"></a></span>
<span id="cb13-131"><a href="#cb13-131"></a><span class="co"># LAYING OUT THE MIDDLE SECTION OF THE APP WITH THE MAPS</span></span>
<span id="cb13-132"><a href="#cb13-132"></a>row2_1, row2_2, row2_3, row2_4 <span class="op">=</span> st.columns((<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-133"><a href="#cb13-133"></a></span>
<span id="cb13-134"><a href="#cb13-134"></a><span class="co"># SETTING THE ZOOM LOCATIONS FOR THE AIRPORTS</span></span>
<span id="cb13-135"><a href="#cb13-135"></a>la_guardia <span class="op">=</span> [<span class="fl">40.7900</span>, <span class="op">-</span><span class="fl">73.8700</span>]</span>
<span id="cb13-136"><a href="#cb13-136"></a>jfk <span class="op">=</span> [<span class="fl">40.6650</span>, <span class="op">-</span><span class="fl">73.7821</span>]</span>
<span id="cb13-137"><a href="#cb13-137"></a>newark <span class="op">=</span> [<span class="fl">40.7090</span>, <span class="op">-</span><span class="fl">74.1805</span>]</span>
<span id="cb13-138"><a href="#cb13-138"></a>zoom_level <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb13-139"><a href="#cb13-139"></a>midpoint <span class="op">=</span> mpoint(data[<span class="st">"lat"</span>], data[<span class="st">"lon"</span>])</span>
<span id="cb13-140"><a href="#cb13-140"></a></span>
<span id="cb13-141"><a href="#cb13-141"></a><span class="cf">with</span> row2_1:</span>
<span id="cb13-142"><a href="#cb13-142"></a>    st.write(</span>
<span id="cb13-143"><a href="#cb13-143"></a>        <span class="ss">f"""**All New York City from </span><span class="sc">{</span>hour_selected<span class="sc">}</span><span class="ss">:00 and </span><span class="sc">{</span>(hour_selected <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">24</span><span class="sc">}</span><span class="ss">:00**"""</span></span>
<span id="cb13-144"><a href="#cb13-144"></a>    )</span>
<span id="cb13-145"><a href="#cb13-145"></a>    <span class="bu">map</span>(filterdata(data, hour_selected), midpoint[<span class="dv">0</span>], midpoint[<span class="dv">1</span>], <span class="dv">11</span>)</span>
<span id="cb13-146"><a href="#cb13-146"></a></span>
<span id="cb13-147"><a href="#cb13-147"></a><span class="cf">with</span> row2_2:</span>
<span id="cb13-148"><a href="#cb13-148"></a>    st.write(<span class="st">"**La Guardia Airport**"</span>)</span>
<span id="cb13-149"><a href="#cb13-149"></a>    <span class="bu">map</span>(filterdata(data, hour_selected), la_guardia[<span class="dv">0</span>], la_guardia[<span class="dv">1</span>], zoom_level)</span>
<span id="cb13-150"><a href="#cb13-150"></a></span>
<span id="cb13-151"><a href="#cb13-151"></a><span class="cf">with</span> row2_3:</span>
<span id="cb13-152"><a href="#cb13-152"></a>    st.write(<span class="st">"**JFK Airport**"</span>)</span>
<span id="cb13-153"><a href="#cb13-153"></a>    <span class="bu">map</span>(filterdata(data, hour_selected), jfk[<span class="dv">0</span>], jfk[<span class="dv">1</span>], zoom_level)</span>
<span id="cb13-154"><a href="#cb13-154"></a></span>
<span id="cb13-155"><a href="#cb13-155"></a><span class="cf">with</span> row2_4:</span>
<span id="cb13-156"><a href="#cb13-156"></a>    st.write(<span class="st">"**Newark Airport**"</span>)</span>
<span id="cb13-157"><a href="#cb13-157"></a>    <span class="bu">map</span>(filterdata(data, hour_selected), newark[<span class="dv">0</span>], newark[<span class="dv">1</span>], zoom_level)</span>
<span id="cb13-158"><a href="#cb13-158"></a></span>
<span id="cb13-159"><a href="#cb13-159"></a><span class="co"># CALCULATING DATA FOR THE HISTOGRAM</span></span>
<span id="cb13-160"><a href="#cb13-160"></a>chart_data <span class="op">=</span> histdata(data, hour_selected)</span>
<span id="cb13-161"><a href="#cb13-161"></a></span>
<span id="cb13-162"><a href="#cb13-162"></a><span class="co"># LAYING OUT THE HISTOGRAM SECTION</span></span>
<span id="cb13-163"><a href="#cb13-163"></a>st.write(</span>
<span id="cb13-164"><a href="#cb13-164"></a>    <span class="ss">f"""**Breakdown of rides per minute between </span><span class="sc">{</span>hour_selected<span class="sc">}</span><span class="ss">:00 and </span><span class="sc">{</span>(hour_selected <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">24</span><span class="sc">}</span><span class="ss">:00**"""</span></span>
<span id="cb13-165"><a href="#cb13-165"></a>)</span>
<span id="cb13-166"><a href="#cb13-166"></a></span>
<span id="cb13-167"><a href="#cb13-167"></a>st.altair_chart(</span>
<span id="cb13-168"><a href="#cb13-168"></a>    alt.Chart(chart_data)</span>
<span id="cb13-169"><a href="#cb13-169"></a>    .mark_area(</span>
<span id="cb13-170"><a href="#cb13-170"></a>        interpolate<span class="op">=</span><span class="st">"step-after"</span>,</span>
<span id="cb13-171"><a href="#cb13-171"></a>    )</span>
<span id="cb13-172"><a href="#cb13-172"></a>    .encode(</span>
<span id="cb13-173"><a href="#cb13-173"></a>        x<span class="op">=</span>alt.X(<span class="st">"minute:Q"</span>, scale<span class="op">=</span>alt.Scale(nice<span class="op">=</span><span class="va">False</span>)),</span>
<span id="cb13-174"><a href="#cb13-174"></a>        y<span class="op">=</span>alt.Y(<span class="st">"pickups:Q"</span>),</span>
<span id="cb13-175"><a href="#cb13-175"></a>        tooltip<span class="op">=</span>[<span class="st">"minute"</span>, <span class="st">"pickups"</span>],</span>
<span id="cb13-176"><a href="#cb13-176"></a>    )</span>
<span id="cb13-177"><a href="#cb13-177"></a>    .configure_mark(opacity<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb13-178"><a href="#cb13-178"></a>    use_container_width<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb13-179"><a href="#cb13-179"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Discussion question ‚Äì Why does <code>map</code> need to take lat and lon as an argument? Answer: this is saying where we should be looking when the map is first created</p>
<p>Show that if you zoom out on the three airports you get back to the exact same underlying dataset, it‚Äôs just starting in a different place.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p>Saw four dashboards</p>
<ul>
<li>Multipage
<ul>
<li>plot</li>
<li>data frame</li>
<li>map</li>
</ul></li>
<li>Uber pickups ‚Äì map + plot</li>
</ul>
</section></section>
<section>
<section id="demystifying-dashboards" class="title-slide slide level1 center">
<h1>Demystifying dashboards</h1>

</section>
<section id="roadmap-1" class="slide level2">
<h2>Roadmap</h2>
<ul>
<li>Why dashboards are different than <code>.py</code> (or notebooks or <code>qmd</code>)</li>
<li>Bare vs streamlit mode</li>
<li>toy example of what streamlit mode can do</li>
<li>What is a session?</li>
</ul>
</section>
<section id="why-dashboards-are-different-than-.py" class="slide level2" style="font-size: 0.8em">
<h2>Why dashboards are different than <code>.py</code></h2>
<p>The first section of this lecture treated dashboards as websites without user input. This is like a normal Python script. Run once and gives you output.</p>
<p>The second section made dashboards interactive. To do this, it must be the case that the entire dashboard, or some part of it, may be run more than once.</p>
<ul>
<li>In Terminal/command line: <code>$ pip install watchdog</code></li>
</ul>
<p><code>watchdog</code> is the file-watching library Streamlit leans on to detect code/data changes (like when we got the option to ‚Äúre-run‚Äù with dashboard 2)</p>
</section>
<section id="bare-mode-vs-streamlit-mode" class="slide level2" style="font-size: 0.8em">
<h2>Bare mode vs streamlit mode</h2>
<ul>
<li>‚ÄúBare mode‚Äù (<code>$ python app.py</code>) runs your script like standard Python; output is just whatever the script prints.</li>
<li>‚ÄúStreamlit mode‚Äù (<code>$ python -m streamlit run app.py</code> or for short <code>$ streamlit run app.py</code>) does four things:
<ul>
<li>sets up a server to run your script</li>
<li>records the state (e.g.&nbsp;the choice in <code>st.selectbox</code>)</li>
<li>reruns code on state changes (e.g.&nbsp;new choice in in <code>st.selectbox</code>)</li>
<li>serves the interactive user interface (UI) found in the browser</li>
</ul></li>
<li>There‚Äôs a lot of extra code under the hood, streamlit‚Äôs goal is for you to focus on the Python code (and ignore all the running a server, taking user input, designing a nice webpage)</li>
</ul>
</section>
<section id="simple-re-run-demo-overview" class="slide level2" style="font-size: 0.8em">
<h2>Simple re-run demo overview</h2>
<p><a href="http://uchicago-harris-dap-dashboards-5.streamlit.app/">http://uchicago-harris-dap-dashboards-5.streamlit.app/</a></p>
<ul>
<li><code>$ streamlit run 5/session_state_example.py</code></li>
<li>User chooses <code>route = st.selectbox("CTA Route", ...)</code> and <code>cut_pct = st.slider("What fraction of service to cut?", ...)</code></li>
<li>Computer then runs a computation which takes 3 seconds (on the pset, you will see an example where it takes much longer than 3 seconds)</li>
<li>Returns a result</li>
<li>What if we want to run the exact same computation twice? Better to use the saved result!</li>
</ul>
</section>
<section id="simple-re-run-demo-review-code" class="slide level2">
<h2>Simple re-run demo review code</h2>
<ul>
<li>Users selects line to cut and percentage cut ‚Äì lines 11 and 12</li>
<li>Record number of calculations done and key for calculations done ‚Äì lines 14-18</li>
<li>If calculation has not been run before, run it ‚Äì lines 21-25</li>
</ul>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="im">import</span> time</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Expensive Calculation"</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>st.title(<span class="st">"Expensive Calculation Demo"</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co"># user inputs</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>route <span class="op">=</span> st.selectbox(<span class="st">"CTA route to cut"</span>, [<span class="st">"Red Line"</span>, <span class="st">"Blue Line"</span>, <span class="st">"Green Line"</span>])</span>
<span id="cb14-10"><a href="#cb14-10"></a>cut_pct <span class="op">=</span> st.slider(<span class="st">"What fraction of service to cut?"</span>, min_value <span class="op">=</span> <span class="fl">0.0</span>, max_value <span class="op">=</span> <span class="fl">50.0</span>, value <span class="op">=</span> <span class="fl">10.0</span>, step<span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="cf">if</span> <span class="st">"counter"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb14-13"><a href="#cb14-13"></a>    st.session_state.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-14"><a href="#cb14-14"></a></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co"># session_state key</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>key <span class="op">=</span> <span class="ss">f"n_pass_</span><span class="sc">{</span>route<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>cut_pct<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb14-17"><a href="#cb14-17"></a></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co"># run the heavy job only if we haven't already stored it</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="cf">if</span> key <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb14-20"><a href="#cb14-20"></a>    <span class="cf">with</span> st.spinner(<span class="st">"Crunching numbers..."</span>):</span>
<span id="cb14-21"><a href="#cb14-21"></a>        time.sleep(<span class="dv">3</span>)  <span class="co"># stand‚Äëin for a slow computation</span></span>
<span id="cb14-22"><a href="#cb14-22"></a>        st.session_state[key] <span class="op">=</span> (<span class="dv">100</span> <span class="op">-</span> cut_pct) <span class="op">*</span> <span class="fl">1.2345</span>  <span class="co"># fake result</span></span>
<span id="cb14-23"><a href="#cb14-23"></a>    st.session_state.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb14-24"><a href="#cb14-24"></a></span>
<span id="cb14-25"><a href="#cb14-25"></a>st.metric(<span class="st">"Expected number of passengers per trip"</span>, <span class="ss">f"</span><span class="sc">{</span>st<span class="sc">.</span>session_state[key]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb14-26"><a href="#cb14-26"></a></span>
<span id="cb14-27"><a href="#cb14-27"></a>st.write(<span class="ss">f"This page has run calculations </span><span class="sc">{</span>st<span class="sc">.</span>session_state<span class="sc">.</span>counter<span class="sc">}</span><span class="ss"> times. Session state keys (programmer tool, would not normally be shown to users):"</span>, <span class="bu">list</span>(st.session_state.keys()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-is-a-session" class="slide level2" style="font-size: 0.8em">
<h2>What is a session?</h2>
<ul>
<li>A session is a single instance of viewing an app.</li>
<li>Multiple users = multiple sessions.</li>
<li>If the user refreshes their browser page or reloads the URL to the app, their Session State resets and they begin again with a new session.</li>
<li>Session State provides a dictionary-like interface where you can preserve info between script reruns. Use <code>st.session_state</code> with key or attribute notation to store and recall values. For example, <code>st.session_state.my_key</code>.</li>
</ul>
</section>
<section id="summary-1" class="slide level2">
<h2>summary</h2>
<ul>
<li>dashboards expect to be run more than once</li>
<li>bare mode lets you test running just once</li>
<li>when you run slow code, save the output</li>
<li>each browser tab is a session</li>
</ul>
</section></section>
<section>
<section id="decorators-and-cache_data" class="title-slide slide level1 center">
<h1>decorators and <code>@cache_data</code></h1>

</section>
<section id="roadmap-2" class="slide level2">
<h2>roadmap</h2>
<ul>
<li>decorator examples
<ul>
<li>timer</li>
<li>crs for spatial joins</li>
<li><code>@cache_data</code></li>
</ul></li>
<li>revisit toy example from last section</li>
<li>real-life example</li>
</ul>
</section>
<section id="timing-pandas-data-processing" class="slide level2">
<h2>Timing pandas data processing</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd, time</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">def</span> timer(func):</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="co">"""Decorator that prints runtime."""</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb15-6"><a href="#cb15-6"></a>        start <span class="op">=</span> time.time()</span>
<span id="cb15-7"><a href="#cb15-7"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb15-8"><a href="#cb15-8"></a>        end <span class="op">=</span> time.time()</span>
<span id="cb15-9"><a href="#cb15-9"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> took </span><span class="sc">{</span>end <span class="op">-</span> start<span class="sc">:.3f}</span><span class="ss"> s"</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>        <span class="cf">return</span> result</span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="at">@timer</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="kw">def</span> summarize(df):</span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="cf">return</span> df.groupby(<span class="st">"city"</span>)[<span class="st">"value"</span>].mean()</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"city"</span>: [<span class="st">"SF"</span>,<span class="st">"NYC"</span>,<span class="st">"LA"</span>,<span class="st">"Chicago"</span>]<span class="op">*</span><span class="dv">3</span>, <span class="st">"value"</span>: <span class="bu">range</span>(<span class="dv">12</span>)})</span>
<span id="cb15-18"><a href="#cb15-18"></a>summary <span class="op">=</span> summarize(df)</span>
<span id="cb15-19"><a href="#cb15-19"></a>summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>summarize took 0.000 s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>city
Chicago    7.0
LA         6.0
NYC        5.0
SF         4.0
Name: value, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="ensure-crs-for-geopandas-joins" class="slide level2">
<h2>Ensure CRS for GeoPandas joins</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">def</span> ensure_crs(crs):</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="co">"""Ensure GeoDataFrames use the same CRS."""</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="kw">def</span> decorator(func): <span class="co">#unlike prior example, this decorator takes an arg</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>        <span class="kw">def</span> wrapper(gdf1, gdf2, <span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb18-7"><a href="#cb18-7"></a>            <span class="cf">if</span> gdf1.crs <span class="op">!=</span> crs:</span>
<span id="cb18-8"><a href="#cb18-8"></a>                gdf1 <span class="op">=</span> gdf1.to_crs(crs)</span>
<span id="cb18-9"><a href="#cb18-9"></a>            <span class="cf">if</span> gdf2.crs <span class="op">!=</span> crs:</span>
<span id="cb18-10"><a href="#cb18-10"></a>                gdf2 <span class="op">=</span> gdf2.to_crs(crs)</span>
<span id="cb18-11"><a href="#cb18-11"></a>            <span class="cf">return</span> func(gdf1, gdf2, <span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb18-12"><a href="#cb18-12"></a>        <span class="cf">return</span> wrapper</span>
<span id="cb18-13"><a href="#cb18-13"></a>    <span class="cf">return</span> decorator</span>
<span id="cb18-14"><a href="#cb18-14"></a></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="at">@ensure_crs</span>(<span class="st">"EPSG:4326"</span>) <span class="co">#center at 0 lat 0 lon</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="kw">def</span> spatial_join(gdf1, gdf2):</span>
<span id="cb18-17"><a href="#cb18-17"></a>    <span class="cf">return</span> gpd.sjoin(gdf1, gdf2, how<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="automate-toy-example-via-cache-ing" class="slide level2">
<h2>Automate toy example via cache-ing</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="at">@st.cache_data</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">def</span> long_running_function(param1, param2):</span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="cf">return</span> ‚Ä¶</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>When user first calls <code>long_running_function(p1, p2)</code> for the first time, <code>@st.cache_data</code> makes a note of <code>p1, p2</code>. It stores the return value in a cache.</li>
<li>If the next call is <code>long_running_function(q1, q2)</code>, it also stores this in the cache.</li>
<li>(time-saving) If the next call is <code>long_running_function(p1, p2)</code>, instead of running any code, it just returns the saved value from the cache.</li>
</ol>
</section>
<section id="do-pair-share-1" class="slide level2" data-background-color="aliceblue">
<h2>do-pair-share</h2>
<ol type="1">
<li>Run <code>$ python app_dps_2.py</code></li>
<li>Edit the script to include a decorator that saves output from prior runs of <code>compute_passengers()</code></li>
<li>Record the change in speed</li>
</ol>
</section>
<section id="cache-data-in-streamlit" class="slide level2">
<h2>cache data in streamlit</h2>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="im">import</span> time</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"@cache_data"</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>st.title(<span class="st">"Expensive Calculation Demo"</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co"># user inputs</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>route <span class="op">=</span> st.selectbox(<span class="st">"CTA route to cut"</span>, [<span class="st">"Red Line"</span>, <span class="st">"Blue Line"</span>, <span class="st">"Green Line"</span>])</span>
<span id="cb20-10"><a href="#cb20-10"></a>cut_pct <span class="op">=</span> st.slider(<span class="st">"What fraction of service to cut?"</span>, <span class="fl">0.0</span>, <span class="fl">50.0</span>, <span class="fl">10.0</span>, step<span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="cf">if</span> <span class="st">"counter"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb20-13"><a href="#cb20-13"></a>    st.session_state.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-14"><a href="#cb20-14"></a></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="at">@st.cache_data</span>()</span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="kw">def</span> compute_passengers(route, cut_pct):</span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="cf">with</span> st.spinner(<span class="st">"Crunching numbers..."</span>):</span>
<span id="cb20-18"><a href="#cb20-18"></a>        time.sleep(<span class="dv">3</span>)  <span class="co"># stand-in for a slow computation</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>    st.session_state.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-20"><a href="#cb20-20"></a>    <span class="cf">return</span> (<span class="dv">100</span> <span class="op">-</span> cut_pct) <span class="op">*</span> <span class="fl">1.2345</span>  <span class="co"># fake result</span></span>
<span id="cb20-21"><a href="#cb20-21"></a>expected_passengers <span class="op">=</span> compute_passengers(route, cut_pct)</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a>st.metric(<span class="st">"Expected number of passengers per trip"</span>, expected_passengers)</span>
<span id="cb20-24"><a href="#cb20-24"></a></span>
<span id="cb20-25"><a href="#cb20-25"></a>st.write(<span class="ss">f"This page has run calculations </span><span class="sc">{</span>st<span class="sc">.</span>session_state<span class="sc">.</span>counter<span class="sc">}</span><span class="ss"> times."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="http://uchicago-harris-dap-dashboards-6.streamlit.app/">http://uchicago-harris-dap-dashboards-6.streamlit.app/</a></p>
</section>
<section id="revisit-a-real-example-4uber_pickups.py" class="slide level2">
<h2>Revisit a real example: <code>4/uber_pickups.py</code></h2>
<p>We have decorated <code>@st.cache_data</code> for four different functions</p>
<ol type="1">
<li><code>load_data()</code></li>
<li><code>filterdata(data, hour_selected)</code></li>
<li><code>mpoint()</code></li>
<li><code>histdata()</code></li>
</ol>
</section>
<section id="summary-what-all-decorators-have-in-common" class="slide level2" style="font-size: 0.8em">
<h2>Summary: What all decorators have in common</h2>
<ul>
<li>All wrap a function with extra behavior.</li>
<li>They take a function as input and return a modified version.</li>
<li>Create them when you know you will use an <strong>already-written</strong> function more than once</li>
<li>Syntax: <code>@decorator</code> above a function definition.</li>
<li>Examples
<ul>
<li>Timing and logging (<code>@timer</code>)</li>
<li>Validation or transformation (<code>@ensure_crs(crs)</code>)</li>
<li>Caching (<code>@st.cache_data</code>)</li>
</ul></li>
<li>Remark: Decorators are not a dashboard-only tool! We can write our own decorators, or use ones that come with a package (st.cache_data is the latter).</li>
</ul>
</section></section>
<section>
<section id="streamlit-and-other-types-of-dashboards" class="title-slide slide level1 center" style="font-size: 0.8em">
<h1>Streamlit and other types of dashboards</h1>

</section>
<section id="roadmap-3" class="slide level2">
<h2>Roadmap</h2>
<ul>
<li>Tips for streamlit</li>
<li>Tips for final project</li>
<li>Streamlit vs other dashboarding software</li>
<li>Promise and pitfalls of dashboards revisited</li>
</ul>
</section>
<section id="streamlit-tips" class="slide level2">
<h2>Streamlit Tips</h2>
<ul>
<li>Lay out your editor and browser windows side by side, so the code and the app can be seen at the same time.</li>
<li>Your main script should live in a directory other than the root directory.</li>
<li><a href="https://docs.streamlit.io/develop/quick-reference/cheat-sheet">https://docs.streamlit.io/develop/quick-reference/cheat-sheet</a></li>
</ul>
</section>
<section id="other-streamlit-applications-we-will-not-cover-examples-on-the-streamlit-website" class="slide level2">
<h2>Other Streamlit applications we will not cover (examples on the streamlit website)</h2>
<ul>
<li>Chat box / LLM wrapper</li>
<li>Draw on external data (user uploaded, from a live database, etc.)</li>
</ul>
</section>
<section id="how-should-you-use-streamlit-for-the-final-project-and-in-life" class="slide level2">
<h2>How should you use streamlit for the final project (and in life)?</h2>
<ul>
<li>Build a dashboard when a static figure or table will not suffice</li>
<li>This occurs when there is too much information to fit on a single figure or table (e.g.&nbsp;one dashboard is better than ten figures)</li>
<li>The goal, however, is not to proliferate information (e.g.&nbsp;‚Äúhow can I imagine ten figures so that then I can shoehorn them into dashboard?‚Äù).</li>
<li>Instead, it is to develop a set of information that a reader or decision-maker would want to interact with.</li>
</ul>
</section>
<section id="streamlit-and-other-dashboarding-tools" class="slide level2" style="font-size: 0.8em">
<h2>Streamlit and other dashboarding tools</h2>
<p>Streamlit is not in the top 10 of most commonly-used dashboards.</p>
<p>What software might you see elsewhere? Microsoft Power BI, tableau, Qlik, Looker, SAP, plotly, shiny</p>
<p>What dashboard should you use? This is not an important choice. Use whatever your organization or collaborators are already using. Or prototype in streamlit and then port.</p>
<p>What if a job you apply for requires a specific dashboarding software? Spend a few hours teaching it to yourself and then put it on your resume (do <strong>not</strong> just put it on your resume). Or put dashbaords in general and learn the skill for the interview.</p>
</section>
<section id="the-most-famous-dashboard-ever" class="slide level2" style="font-size: 0.8em">
<h2>The most famous dashboard ever</h2>
<p>New York City Police Department‚Äôs ‚ÄúCompStat‚Äù in the 1990‚Äôs. Why is it such a perfect application of a dashboard? (Source: <em>Classic book: Bob Behn‚Äôs <a href="https://www.brookings.edu/books/the-performancestat-potential/">The PerformanceStat Potential</a></em>)</p>
<!-- note to self: I skipped 4 and 7 since I didn't think they make a lot of sense-->
<ol type="1">
<li>Metrics (arrests, crime rate) are clearly aligned with institutional goals</li>
<li>Data are automatically collected daily</li>
<li>Historical baseline data are available</li>
<li>Focused efforts can produce immediate results</li>
<li>All police commanders start as beat cops</li>
<li>Multiple subunits facilitate comparison</li>
<li>Size plus managerial discretion creates personnel flexibility</li>
</ol>
<p>Very few other parts of government can meet all seven of these criteria</p>
</section>
<section id="skeptic" class="slide level2">
<h2>Skeptic</h2>
<p>Even under these perfect conditions, the dashboard was not very successful. In a survey of 1800 retired NYC police officers of the question ‚Äúare you confident that major crimes have declined by 80% in New York since 1990s?‚Äù more than half said no (Eterno, Verma, and Silverman 2014). Respondents also talked about pressure to change reports to make crime look better.</p>
<p>The key idea is that ‚Äúwhat gets measured gets managed‚Äù. Once a manger focuses on a metric, that metric becomes less useful or informative than it was before.</p>
</section>
<section id="conclusion-of-section" class="slide level2">
<h2>Conclusion of section</h2>
<ul>
<li>Streamlit is an amazing tool</li>
<li>The key skill, however, is not streamlit, it is organizing information for an external analyst or decision-maker.</li>
<li>Dashboards have real downsides</li>
<li>In spite of these downsides, dashboards continue to grow in popularity</li>
</ul>
</section></section>
<section>
<section id="backup-slides" class="title-slide slide level1 center">
<h1>Backup slides</h1>

</section>
<section id="backup-altair-troubleshooting" class="slide level2">
<h2>Backup: Altair troubleshooting</h2>
<ul>
<li>It is possible to have Altair installed (as captured by <code>pip show altair</code>) but also have <code>import altair</code> fail on mac with a chip architecture error: <code>have 'x86_64', need 'arm64e' or 'arm64')</code></li>
<li>Didn‚Äôt work: make a new <code>venv</code> or update Python.</li>
<li>Worked: <code>pip install --force-reinstall --no-cache-dir --only-binary=:all: rpds-py</code></li>
</ul>
</section>
<section id="backup-altair-troubleshooting-1" class="slide level2">
<h2>Backup: Altair troubleshooting</h2>
<p>‚ÄúThis is a compatibility issue between the package‚Äôs [altair‚Äôs] generated schema and Python 3.14.‚Äù</p>
<p>Solution: downgrade to Python 3.12.</p>
</section>
<section id="backup-streamlit-troubleshooting" class="slide level2">
<h2>Backup: Streamlit troubleshooting</h2>
<p>Make sure that your virtual environment is active!</p>
<p>urllib.error.URLError: &lt;urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1000)&gt;</p>
<p>Solution Find your Python‚Äôs ‚ÄúInstall Certificates.command‚Äù in Finder: 1. Open&nbsp;/Applications. 2. Enter the folder for your Python (for example&nbsp;Python 3.11). 3. Double-click&nbsp;Install Certificates.command.</p>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="dashboards_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="dashboards_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="dashboards_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>